<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="GenHook Development Team" />
  <meta name="dcterms.date" content="2025-08-07" />
  <title>GenHook Complete Documentation Suite</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../styles.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">GenHook Complete Documentation Suite</h1>
<p class="author">GenHook Development Team</p>
<p class="date">2025-08-07</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#genhook-project-notes"
id="toc-genhook-project-notes"><span class="toc-section-number">1</span>
GenHook Project Notes</a>
<ul>
<li><a href="#project-overview" id="toc-project-overview"><span
class="toc-section-number">1.1</span> Project Overview</a>
<ul>
<li><a href="#system-purpose" id="toc-system-purpose"><span
class="toc-section-number">1.1.1</span> System Purpose</a></li>
<li><a href="#key-features" id="toc-key-features"><span
class="toc-section-number">1.1.2</span> Key Features</a></li>
<li><a href="#architecture" id="toc-architecture"><span
class="toc-section-number">1.1.3</span> Architecture</a></li>
</ul></li>
<li><a href="#backend-startup" id="toc-backend-startup"><span
class="toc-section-number">1.2</span> Backend Startup</a></li>
<li><a href="#web-configuration-interface"
id="toc-web-configuration-interface"><span
class="toc-section-number">1.3</span> Web Configuration Interface</a>
<ul>
<li><a href="#overview" id="toc-overview"><span
class="toc-section-number">1.3.1</span> Overview</a></li>
<li><a href="#access" id="toc-access"><span
class="toc-section-number">1.3.2</span> Access</a></li>
<li><a href="#features" id="toc-features"><span
class="toc-section-number">1.3.3</span> Features</a></li>
<li><a href="#quick-start-guide" id="toc-quick-start-guide"><span
class="toc-section-number">1.3.4</span> Quick Start Guide</a></li>
<li><a href="#configuration-file-integration"
id="toc-configuration-file-integration"><span
class="toc-section-number">1.3.5</span> Configuration File
Integration</a></li>
<li><a href="#web-interface-configuration"
id="toc-web-interface-configuration"><span
class="toc-section-number">1.3.6</span> Web Interface
Configuration</a></li>
</ul></li>
<li><a href="#supported-webhook-sources"
id="toc-supported-webhook-sources"><span
class="toc-section-number">1.4</span> Supported Webhook Sources</a>
<ul>
<li><a href="#service-providers" id="toc-service-providers"><span
class="toc-section-number">1.4.1</span> Service Providers</a></li>
<li><a href="#configuration-format" id="toc-configuration-format"><span
class="toc-section-number">1.4.2</span> Configuration Format</a></li>
<li><a href="#field-extraction-patterns"
id="toc-field-extraction-patterns"><span
class="toc-section-number">1.4.3</span> Field Extraction
Patterns</a></li>
</ul></li>
<li><a href="#technical-architecture"
id="toc-technical-architecture"><span
class="toc-section-number">1.5</span> Technical Architecture</a>
<ul>
<li><a href="#threading-models" id="toc-threading-models"><span
class="toc-section-number">1.5.1</span> Threading Models</a></li>
<li><a href="#configuration-parameters"
id="toc-configuration-parameters"><span
class="toc-section-number">1.5.2</span> Configuration
Parameters</a></li>
<li><a href="#sl1-integration" id="toc-sl1-integration"><span
class="toc-section-number">1.5.3</span> SL1 Integration</a></li>
<li><a href="#queue-management" id="toc-queue-management"><span
class="toc-section-number">1.5.4</span> Queue Management</a></li>
</ul></li>
<li><a href="#configuration-system" id="toc-configuration-system"><span
class="toc-section-number">1.6</span> Configuration System</a>
<ul>
<li><a href="#template-variables" id="toc-template-variables"><span
class="toc-section-number">1.6.1</span> Template Variables</a></li>
<li><a href="#template-examples" id="toc-template-examples"><span
class="toc-section-number">1.6.2</span> Template Examples</a></li>
<li><a href="#environment-configuration"
id="toc-environment-configuration"><span
class="toc-section-number">1.6.3</span> Environment
Configuration</a></li>
</ul></li>
<li><a href="#development-phases" id="toc-development-phases"><span
class="toc-section-number">1.7</span> Development Phases</a>
<ul>
<li><a href="#phase-1-core-system" id="toc-phase-1-core-system"><span
class="toc-section-number">1.7.1</span> Phase 1: Core System</a></li>
<li><a href="#phase-2-multi-threading"
id="toc-phase-2-multi-threading"><span
class="toc-section-number">1.7.2</span> Phase 2:
Multi-Threading</a></li>
<li><a href="#phase-3-production-features"
id="toc-phase-3-production-features"><span
class="toc-section-number">1.7.3</span> Phase 3: Production
Features</a></li>
<li><a href="#phase-4-operations" id="toc-phase-4-operations"><span
class="toc-section-number">1.7.4</span> Phase 4: Operations</a></li>
<li><a href="#current-status" id="toc-current-status"><span
class="toc-section-number">1.7.5</span> Current Status</a></li>
</ul></li>
<li><a href="#production-deployment"
id="toc-production-deployment"><span
class="toc-section-number">1.8</span> Production Deployment</a>
<ul>
<li><a href="#port-configuration-configuration-driven"
id="toc-port-configuration-configuration-driven"><span
class="toc-section-number">1.8.1</span> Port Configuration
(Configuration-Driven)</a></li>
<li><a href="#aws-deployment-considerations"
id="toc-aws-deployment-considerations"><span
class="toc-section-number">1.8.2</span> AWS Deployment
Considerations</a></li>
<li><a href="#reverse-proxy-configuration-nginx"
id="toc-reverse-proxy-configuration-nginx"><span
class="toc-section-number">1.8.3</span> Reverse Proxy Configuration
(nginx)</a></li>
<li><a href="#environment-variables-for-production"
id="toc-environment-variables-for-production"><span
class="toc-section-number">1.8.4</span> Environment Variables for
Production</a></li>
<li><a href="#configuration-files-for-production"
id="toc-configuration-files-for-production"><span
class="toc-section-number">1.8.5</span> Configuration Files for
Production</a></li>
<li><a href="#security-checklist" id="toc-security-checklist"><span
class="toc-section-number">1.8.6</span> Security Checklist</a></li>
</ul></li>
<li><a href="#security-performance" id="toc-security-performance"><span
class="toc-section-number">1.9</span> Security &amp; Performance</a>
<ul>
<li><a href="#security-considerations"
id="toc-security-considerations"><span
class="toc-section-number">1.9.1</span> Security Considerations</a></li>
<li><a href="#error-handling-strategy"
id="toc-error-handling-strategy"><span
class="toc-section-number">1.9.2</span> Error Handling Strategy</a></li>
<li><a href="#performance-optimization"
id="toc-performance-optimization"><span
class="toc-section-number">1.9.3</span> Performance
Optimization</a></li>
<li><a href="#monitoring-points" id="toc-monitoring-points"><span
class="toc-section-number">1.9.4</span> Monitoring Points</a></li>
<li><a href="#key-metrics-to-track" id="toc-key-metrics-to-track"><span
class="toc-section-number">1.9.5</span> Key Metrics to Track</a></li>
</ul></li>
<li><a href="#web-configuration-interface-plan"
id="toc-web-configuration-interface-plan"><span
class="toc-section-number">1.10</span> Web Configuration Interface
Plan</a>
<ul>
<li><a href="#overview-1" id="toc-overview-1"><span
class="toc-section-number">1.10.1</span> Overview</a></li>
<li><a href="#key-features-1" id="toc-key-features-1"><span
class="toc-section-number">1.10.2</span> Key Features</a></li>
<li><a href="#architecture-1" id="toc-architecture-1"><span
class="toc-section-number">1.10.3</span> Architecture</a></li>
<li><a href="#implementation-structure"
id="toc-implementation-structure"><span
class="toc-section-number">1.10.4</span> Implementation
Structure</a></li>
<li><a href="#user-workflow" id="toc-user-workflow"><span
class="toc-section-number">1.10.5</span> User Workflow</a></li>
<li><a href="#documentation" id="toc-documentation"><span
class="toc-section-number">1.10.6</span> Documentation</a></li>
<li><a href="#benefits" id="toc-benefits"><span
class="toc-section-number">1.10.7</span> Benefits</a></li>
</ul></li>
</ul></li>
<li><a href="#genhook-production-deployment-guide"
id="toc-genhook-production-deployment-guide"><span
class="toc-section-number">2</span> GenHook Production Deployment
Guide</a>
<ul>
<li><a href="#overview-2" id="toc-overview-2"><span
class="toc-section-number">2.1</span> Overview</a></li>
<li><a href="#architecture-overview"
id="toc-architecture-overview"><span
class="toc-section-number">2.2</span> Architecture Overview</a></li>
<li><a href="#pre-production-checklist"
id="toc-pre-production-checklist"><span
class="toc-section-number">2.3</span> Pre-Production Checklist</a>
<ul>
<li><a href="#code-readiness" id="toc-code-readiness"><span
class="toc-section-number">2.3.1</span> ‚úÖ Code Readiness</a></li>
<li><a href="#security" id="toc-security"><span
class="toc-section-number">2.3.2</span> ‚úÖ Security</a></li>
<li><a href="#configuration" id="toc-configuration"><span
class="toc-section-number">2.3.3</span> ‚úÖ Configuration</a></li>
</ul></li>
<li><a href="#port-configuration-strategy"
id="toc-port-configuration-strategy"><span
class="toc-section-number">2.4</span> Port Configuration Strategy</a>
<ul>
<li><a href="#configuration-files" id="toc-configuration-files"><span
class="toc-section-number">2.4.1</span> Configuration Files</a></li>
<li><a href="#port-configuration-options"
id="toc-port-configuration-options"><span
class="toc-section-number">2.4.2</span> Port Configuration
Options</a></li>
<li><a href="#configuration-priority"
id="toc-configuration-priority"><span
class="toc-section-number">2.4.3</span> Configuration Priority</a></li>
</ul></li>
<li><a href="#deployment-options" id="toc-deployment-options"><span
class="toc-section-number">2.5</span> Deployment Options</a>
<ul>
<li><a
href="#option-1-aws-ec2-with-application-load-balancer-recommended"
id="toc-option-1-aws-ec2-with-application-load-balancer-recommended"><span
class="toc-section-number">2.5.1</span> Option 1: AWS EC2 with
Application Load Balancer (Recommended)</a></li>
<li><a href="#option-2-docker-deployment"
id="toc-option-2-docker-deployment"><span
class="toc-section-number">2.5.2</span> Option 2: Docker
Deployment</a></li>
</ul></li>
<li><a href="#configuration-management-1"
id="toc-configuration-management-1"><span
class="toc-section-number">2.6</span> Configuration Management</a>
<ul>
<li><a href="#production-configuration-files"
id="toc-production-configuration-files"><span
class="toc-section-number">2.6.1</span> Production Configuration
Files</a></li>
</ul></li>
<li><a href="#monitoring-and-logging"
id="toc-monitoring-and-logging"><span
class="toc-section-number">2.7</span> Monitoring and Logging</a>
<ul>
<li><a href="#cloudwatch-integration-aws"
id="toc-cloudwatch-integration-aws"><span
class="toc-section-number">2.7.1</span> CloudWatch Integration
(AWS)</a></li>
<li><a href="#metrics-and-alerts" id="toc-metrics-and-alerts"><span
class="toc-section-number">2.7.2</span> Metrics and Alerts</a></li>
</ul></li>
<li><a href="#security-configuration"
id="toc-security-configuration"><span
class="toc-section-number">2.8</span> Security Configuration</a>
<ul>
<li><a href="#ssltls-setup" id="toc-ssltls-setup"><span
class="toc-section-number">2.8.1</span> SSL/TLS Setup</a></li>
<li><a href="#access-control" id="toc-access-control"><span
class="toc-section-number">2.8.2</span> Access Control</a></li>
<li><a href="#webhook-signature-verification"
id="toc-webhook-signature-verification"><span
class="toc-section-number">2.8.3</span> Webhook Signature
Verification</a></li>
</ul></li>
<li><a href="#backup-and-recovery" id="toc-backup-and-recovery"><span
class="toc-section-number">2.9</span> Backup and Recovery</a>
<ul>
<li><a href="#automated-backups" id="toc-automated-backups"><span
class="toc-section-number">2.9.1</span> Automated Backups</a></li>
<li><a href="#recovery-procedure" id="toc-recovery-procedure"><span
class="toc-section-number">2.9.2</span> Recovery Procedure</a></li>
</ul></li>
<li><a href="#performance-tuning" id="toc-performance-tuning"><span
class="toc-section-number">2.10</span> Performance Tuning</a>
<ul>
<li><a href="#application-settings" id="toc-application-settings"><span
class="toc-section-number">2.10.1</span> Application Settings</a></li>
<li><a href="#system-tuning" id="toc-system-tuning"><span
class="toc-section-number">2.10.2</span> System Tuning</a></li>
</ul></li>
<li><a href="#troubleshooting" id="toc-troubleshooting"><span
class="toc-section-number">2.11</span> Troubleshooting</a>
<ul>
<li><a href="#common-issues" id="toc-common-issues"><span
class="toc-section-number">2.11.1</span> Common Issues</a></li>
<li><a href="#log-analysis" id="toc-log-analysis"><span
class="toc-section-number">2.11.2</span> Log Analysis</a></li>
</ul></li>
<li><a href="#maintenance" id="toc-maintenance"><span
class="toc-section-number">2.12</span> Maintenance</a>
<ul>
<li><a href="#updates" id="toc-updates"><span
class="toc-section-number">2.12.1</span> Updates</a></li>
<li><a href="#health-monitoring" id="toc-health-monitoring"><span
class="toc-section-number">2.12.2</span> Health Monitoring</a></li>
</ul></li>
</ul></li>
<li><a href="#genhook-aws-deployment-guide"
id="toc-genhook-aws-deployment-guide"><span
class="toc-section-number">3</span> GenHook AWS Deployment Guide</a>
<ul>
<li><a href="#overview-3" id="toc-overview-3"><span
class="toc-section-number">3.1</span> Overview</a></li>
<li><a href="#architecture-diagram" id="toc-architecture-diagram"><span
class="toc-section-number">3.2</span> Architecture Diagram</a></li>
<li><a href="#aws-services-used" id="toc-aws-services-used"><span
class="toc-section-number">3.3</span> AWS Services Used</a></li>
<li><a href="#step-by-step-deployment"
id="toc-step-by-step-deployment"><span
class="toc-section-number">3.4</span> Step-by-Step Deployment</a>
<ul>
<li><a href="#vpc-and-security-setup"
id="toc-vpc-and-security-setup"><span
class="toc-section-number">3.4.1</span> 1. VPC and Security
Setup</a></li>
<li><a href="#ssl-certificate-setup"
id="toc-ssl-certificate-setup"><span
class="toc-section-number">3.4.2</span> 2. SSL Certificate
Setup</a></li>
<li><a href="#secrets-manager-setup"
id="toc-secrets-manager-setup"><span
class="toc-section-number">3.4.3</span> 3. Secrets Manager
Setup</a></li>
<li><a href="#launch-template-creation"
id="toc-launch-template-creation"><span
class="toc-section-number">3.4.4</span> 4. Launch Template
Creation</a></li>
<li><a href="#iam-roles-and-policies"
id="toc-iam-roles-and-policies"><span
class="toc-section-number">3.4.5</span> 5. IAM Roles and
Policies</a></li>
<li><a href="#application-load-balancer-setup"
id="toc-application-load-balancer-setup"><span
class="toc-section-number">3.4.6</span> 6. Application Load Balancer
Setup</a></li>
<li><a href="#auto-scaling-group" id="toc-auto-scaling-group"><span
class="toc-section-number">3.4.7</span> 7. Auto Scaling Group</a></li>
<li><a href="#cloudwatch-monitoring"
id="toc-cloudwatch-monitoring"><span
class="toc-section-number">3.4.8</span> 8. CloudWatch
Monitoring</a></li>
<li><a href="#route-53-dns-setup" id="toc-route-53-dns-setup"><span
class="toc-section-number">3.4.9</span> 9. Route 53 DNS Setup</a></li>
<li><a href="#configuration-backup-to-s3"
id="toc-configuration-backup-to-s3"><span
class="toc-section-number">3.4.10</span> 10. Configuration Backup to
S3</a></li>
</ul></li>
<li><a href="#web-interface-access-control"
id="toc-web-interface-access-control"><span
class="toc-section-number">3.5</span> Web Interface Access Control</a>
<ul>
<li><a href="#alb-listener-rules-for-web-interface"
id="toc-alb-listener-rules-for-web-interface"><span
class="toc-section-number">3.5.1</span> ALB Listener Rules for Web
Interface</a></li>
</ul></li>
<li><a href="#cost-optimization" id="toc-cost-optimization"><span
class="toc-section-number">3.6</span> Cost Optimization</a>
<ul>
<li><a href="#instance-rightsizing" id="toc-instance-rightsizing"><span
class="toc-section-number">3.6.1</span> Instance Rightsizing</a></li>
<li><a href="#reserved-instances" id="toc-reserved-instances"><span
class="toc-section-number">3.6.2</span> Reserved Instances</a></li>
</ul></li>
<li><a href="#disaster-recovery" id="toc-disaster-recovery"><span
class="toc-section-number">3.7</span> Disaster Recovery</a>
<ul>
<li><a href="#multi-az-deployment" id="toc-multi-az-deployment"><span
class="toc-section-number">3.7.1</span> Multi-AZ Deployment</a></li>
<li><a href="#cross-region-backup" id="toc-cross-region-backup"><span
class="toc-section-number">3.7.2</span> Cross-Region Backup</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1" id="genhook-project-notes"><span
class="header-section-number">1</span> GenHook Project Notes</h1>
<h2 data-number="1.1" id="project-overview"><span
class="header-section-number">1.1</span> Project Overview</h2>
<h3 data-number="1.1.1" id="system-purpose"><span
class="header-section-number">1.1.1</span> System Purpose</h3>
<p>GenHook is a configuration-driven, multi-threaded webhook receiver
that: - Accepts webhooks from multiple services (GitHub, Stripe, Slack,
AWS, etc.) - Extracts specified fields using configuration files -
Generates human-readable messages using templates - Forwards events to
SL1 monitoring system via API</p>
<h3 data-number="1.1.2" id="key-features"><span
class="header-section-number">1.1.2</span> Key Features</h3>
<ul>
<li><strong>Configuration-Driven</strong>: No code changes needed for
new webhook types</li>
<li><strong>Multi-Threaded</strong>: Handle thousands of concurrent
webhooks</li>
<li><strong>Template-Based Messaging</strong>: Flexible message
generation</li>
<li><strong>SL1 Integration</strong>: Direct API integration with
default values</li>
<li><strong>Error Handling</strong>: Graceful failure handling and retry
logic</li>
</ul>
<h3 data-number="1.1.3" id="architecture"><span
class="header-section-number">1.1.3</span> Architecture</h3>
<ul>
<li>FastAPI-based HTTP server</li>
<li>7-step processing pipeline: Reception ‚Üí Identification ‚Üí
Configuration Lookup ‚Üí Field Extraction ‚Üí Message Generation ‚Üí SL1 API
Call ‚Üí Error Handling</li>
<li>Configurable threading models: Thread Pool Pattern, Async Event
Loop, or Hybrid Approach</li>
<li>Queue management with in-memory and persistent options</li>
</ul>
<h2 data-number="1.2" id="backend-startup"><span
class="header-section-number">1.2</span> Backend Startup</h2>
<p>Always start the backend when working on this project:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> backend <span class="kw">&amp;&amp;</span> <span class="ex">./start.sh</span></span></code></pre></div>
<p>Or manually:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> backend</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> ../venv/bin/activate</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> main.py</span></code></pre></div>
<p>Backend runs at: http://localhost:8000 API docs at:
http://localhost:8000/docs</p>
<h2 data-number="1.3" id="web-configuration-interface"><span
class="header-section-number">1.3</span> Web Configuration
Interface</h2>
<h3 data-number="1.3.1" id="overview"><span
class="header-section-number">1.3.1</span> Overview</h3>
<p>GenHook includes a comprehensive web-based configuration interface
that eliminates the need to manually edit configuration files. The
interface provides a 3-step wizard for creating webhook configurations
with visual field selection and real-time testing.</p>
<h3 data-number="1.3.2" id="access"><span
class="header-section-number">1.3.2</span> Access</h3>
<ul>
<li><strong>Web Interface</strong>: http://localhost:8000/config</li>
<li><strong>Configuration Management</strong>: Visual webhook
configuration without manual file editing</li>
<li><strong>Test Functionality</strong>: Real-time testing of webhook
configurations before saving</li>
</ul>
<h3 data-number="1.3.3" id="features"><span
class="header-section-number">1.3.3</span> Features</h3>
<h4 data-number="1.3.3.1" id="step-configuration-wizard"><span
class="header-section-number">1.3.3.1</span> 1. <strong>3-Step
Configuration Wizard</strong></h4>
<ul>
<li><strong>Step 1: Payload Analysis</strong> - Upload sample JSON
payloads for field discovery</li>
<li><strong>Step 2: Field Selection</strong> - Visually select fields
with nested pattern support<br />
</li>
<li><strong>Step 3: Template Building</strong> - Create message
templates with live preview and testing</li>
</ul>
<h4 data-number="1.3.3.2" id="visual-field-selection"><span
class="header-section-number">1.3.3.2</span> 2. <strong>Visual Field
Selection</strong></h4>
<ul>
<li>Automatic discovery of extractable fields from JSON payloads</li>
<li>Support for deeply nested patterns like
<code>data{object}{amount}</code></li>
<li>Filtering to show only leaf nodes (fields with actual values)</li>
<li>Real-time pattern generation for selected fields</li>
</ul>
<h4 data-number="1.3.3.3" id="test-before-save"><span
class="header-section-number">1.3.3.3</span> 3.
<strong>Test-Before-Save</strong></h4>
<ul>
<li>Test webhook configurations with real payloads before saving</li>
<li>Live field extraction and template variable substitution</li>
<li>Performance metrics (processing time)</li>
<li>Error handling and validation feedback</li>
</ul>
<h4 data-number="1.3.3.4" id="edit-mode"><span
class="header-section-number">1.3.3.4</span> 4. <strong>Edit
Mode</strong></h4>
<ul>
<li>Load existing configurations for modification</li>
<li>Add test payloads for testing configuration changes</li>
<li>Proper variable context for existing field selections</li>
<li>Update existing configurations safely</li>
</ul>
<h4 data-number="1.3.3.5" id="configuration-management"><span
class="header-section-number">1.3.3.5</span> 5. <strong>Configuration
Management</strong></h4>
<ul>
<li>View all current webhook configurations in a table</li>
<li>Edit and delete existing configurations</li>
<li>Automatic backup creation before changes</li>
<li>Real-time table updates after save/delete operations</li>
</ul>
<h3 data-number="1.3.4" id="quick-start-guide"><span
class="header-section-number">1.3.4</span> Quick Start Guide</h3>
<h4 data-number="1.3.4.1"
id="creating-a-new-webhook-configuration"><span
class="header-section-number">1.3.4.1</span> Creating a New Webhook
Configuration:</h4>
<ol type="1">
<li>Navigate to http://localhost:8000/config</li>
<li>Enter a webhook type name (e.g., ‚Äúgithub‚Äù, ‚Äústripe‚Äù)</li>
<li>Paste a sample JSON payload from your webhook source</li>
<li>Click ‚ÄúAnalyze Payload‚Äù to discover available fields</li>
<li>Select the fields you want to extract</li>
<li>Create a message template using variables like
<code>$field.name$</code></li>
<li>Click ‚ÄúTest Config‚Äù to verify the configuration works</li>
<li>Click ‚ÄúSave Configuration‚Äù to add it to your webhook-config.ini</li>
</ol>
<h4 data-number="1.3.4.2" id="editing-existing-configurations"><span
class="header-section-number">1.3.4.2</span> Editing Existing
Configurations:</h4>
<ol type="1">
<li>Click the edit button (pencil icon) on any configuration in the
table</li>
<li>Modify the message template as needed</li>
<li>Click ‚ÄúAdd Test Payload‚Äù to provide sample data for testing</li>
<li>Paste a JSON payload and click ‚ÄúTest Config‚Äù</li>
<li>Click ‚ÄúSave Configuration‚Äù to update the existing configuration</li>
</ol>
<h3 data-number="1.3.5" id="configuration-file-integration"><span
class="header-section-number">1.3.5</span> Configuration File
Integration</h3>
<ul>
<li>Configurations are saved to
<code>backend/config/webhook-config.ini</code></li>
<li>Automatic backup creation in
<code>backend/config/backups/</code></li>
<li>Service restart capability (configurable)</li>
<li>No manual file editing required</li>
</ul>
<h3 data-number="1.3.6" id="web-interface-configuration"><span
class="header-section-number">1.3.6</span> Web Interface
Configuration</h3>
<p>The web interface can be configured via
<code>backend/config/web-config.ini</code>:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[ui]</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="dt">enabled </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="dt">max_analysis_depth </span><span class="ot">=</span><span class="st"> </span><span class="dv">3</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="dt">timeout_seconds </span><span class="ot">=</span><span class="st"> </span><span class="dv">30</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">[features]</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="dt">auto_restart_service </span><span class="ot">=</span><span class="st"> false  # Set to true in production</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="dt">backup_configs </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span></span></code></pre></div>
<h2 data-number="1.4" id="supported-webhook-sources"><span
class="header-section-number">1.4</span> Supported Webhook Sources</h2>
<h3 data-number="1.4.1" id="service-providers"><span
class="header-section-number">1.4.1</span> Service Providers</h3>
<ul>
<li><strong>GitHub</strong>: Push, Pull Request, Issues, Releases</li>
<li><strong>Stripe</strong>: Payments, Subscriptions, Customers</li>
<li><strong>Slack</strong>: Messages, User Actions, App Events</li>
<li><strong>AWS EventBridge/CloudWatch</strong>: EC2, Lambda, S3,
CloudFormation</li>
<li><strong>Cisco Meraki</strong>: Device Alerts, Network Events,
Security Events</li>
<li><strong>Jira</strong>: Issue Updates, Comments, Transitions</li>
<li><strong>Azure Event Grid</strong>: Storage, Resource Management,
Service Bus</li>
<li><strong>Shopify</strong>: Orders, Customers, Products,
Inventory</li>
</ul>
<h3 data-number="1.4.2" id="configuration-format"><span
class="header-section-number">1.4.2</span> Configuration Format</h3>
<p>Each webhook type is configured using INI syntax:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="dt">webhook_type: field1,field2,nested{subfield}::Message template with $variables$</span></span></code></pre></div>
<h3 data-number="1.4.3" id="field-extraction-patterns"><span
class="header-section-number">1.4.3</span> Field Extraction
Patterns</h3>
<ul>
<li><strong>Simple Field</strong>: <code>field_name</code></li>
<li><strong>Nested Object</strong>: <code>object{subfield}</code></li>
<li><strong>Deep Nesting</strong>:
<code>level1{level2{level3}}</code></li>
<li><strong>Arrays</strong>:
<code>array_field{item_property}</code></li>
</ul>
<h2 data-number="1.5" id="technical-architecture"><span
class="header-section-number">1.5</span> Technical Architecture</h2>
<h3 data-number="1.5.1" id="threading-models"><span
class="header-section-number">1.5.1</span> Threading Models</h3>
<ol type="1">
<li><strong>Thread Pool Pattern</strong>: HTTP Server ‚Üí Request Queue ‚Üí
Thread Pool ‚Üí SL1 API
<ul>
<li>Use Case: Moderate loads (&lt; 1000 req/sec)</li>
<li>Pros: Simple, predictable resource usage</li>
<li>Cons: Thread creation overhead</li>
</ul></li>
<li><strong>Async Event Loop</strong>: Event Loop ‚Üí Async Tasks ‚Üí
Non-blocking I/O
<ul>
<li>Use Case: High concurrency, I/O bound</li>
<li>Pros: Memory efficient, handles 10k+ connections</li>
<li>Cons: Single-threaded CPU processing</li>
</ul></li>
<li><strong>Hybrid Approach</strong>: Async HTTP ‚Üí Message Queue ‚Üí
Worker Thread Pool
<ul>
<li>Use Case: Mixed CPU/I/O workloads</li>
<li>Pros: Best of both worlds</li>
<li>Cons: More complex architecture</li>
</ul></li>
</ol>
<h3 data-number="1.5.2" id="configuration-parameters"><span
class="header-section-number">1.5.2</span> Configuration Parameters</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Threading Configuration</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="dt">max_worker_threads </span><span class="ot">=</span><span class="st"> </span><span class="dv">50</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="dt">queue_max_size </span><span class="ot">=</span><span class="st"> </span><span class="dv">10000</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="dt">processing_timeout </span><span class="ot">=</span><span class="st"> 30s</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="dt">retry_max_attempts </span><span class="ot">=</span><span class="st"> </span><span class="dv">3</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="dt">shutdown_grace_period </span><span class="ot">=</span><span class="st"> 60s</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Per-webhook limits</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="dt">shopify_max_concurrent </span><span class="ot">=</span><span class="st"> </span><span class="dv">10</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="dt">slack_max_concurrent </span><span class="ot">=</span><span class="st"> </span><span class="dv">20</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="dt">aws_max_concurrent </span><span class="ot">=</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="dt">meraki_max_concurrent </span><span class="ot">=</span><span class="st"> </span><span class="dv">25</span></span></code></pre></div>
<h3 data-number="1.5.3" id="sl1-integration"><span
class="header-section-number">1.5.3</span> SL1 Integration</h3>
<ul>
<li><strong>API Endpoint</strong>: <code>POST /api/alert</code></li>
<li><strong>Authentication</strong>: HTTP Basic Auth
(username/password)</li>
<li><strong>Payload Format</strong>: Simplified JSON with only
<code>message</code> field populated</li>
<li><strong>Default Values</strong>: All other fields use SL1
defaults</li>
<li><strong>Retry Logic</strong>: Exponential backoff for failed API
calls</li>
</ul>
<h3 data-number="1.5.4" id="queue-management"><span
class="header-section-number">1.5.4</span> Queue Management</h3>
<ul>
<li><strong>In-Memory</strong>: Low latency, volatile</li>
<li><strong>Persistent</strong>: Redis/RabbitMQ for reliability</li>
<li><strong>Priority</strong>: Different webhook types by
importance</li>
<li><strong>Dead Letter</strong>: Failed processing queue</li>
</ul>
<h2 data-number="1.6" id="configuration-system"><span
class="header-section-number">1.6</span> Configuration System</h2>
<h3 data-number="1.6.1" id="template-variables"><span
class="header-section-number">1.6.1</span> Template Variables</h3>
<ul>
<li><strong>Simple Substitution</strong>: <code>$field_name$</code></li>
<li><strong>Nested Access</strong>: <code>$object.subfield$</code></li>
<li><strong>Array Access</strong>: <code>$array[0].property$</code></li>
</ul>
<h3 data-number="1.6.2" id="template-examples"><span
class="header-section-number">1.6.2</span> Template Examples</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GitHub Events</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="dt">github: action,pull_request{title,user{login}},repository{name}::GitHub $action$ on $repository.name$: &quot;$pull_request.title$&quot; by $pull_request.user.login$</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Stripe Payments</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="dt">stripe: type,data{object{amount,currency,status}}::Stripe $type$: Payment of $data.object.amount$ $data.object.currency$ status: $data.object.status$</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Slack Messages  </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="dt">slack: event{type,user,text}::Slack $event.type$ from user $event.user$: &quot;$event.text$&quot;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># AWS Events</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="dt">aws: detail-type,source,region,detail{instance-id,state}::AWS $detail-type$ from $source$ in $region$: Instance $detail.instance-id$ state: $detail.state$</span></span></code></pre></div>
<h3 data-number="1.6.3" id="environment-configuration"><span
class="header-section-number">1.6.3</span> Environment
Configuration</h3>
<div class="sourceCode" id="cb7"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Server Settings</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="dt">server_port </span><span class="ot">=</span><span class="st"> </span><span class="dv">8080</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="dt">server_host </span><span class="ot">=</span><span class="st"> 0.0.0.0</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="dt">ssl_enabled </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="dt">ssl_cert_path </span><span class="ot">=</span><span class="st"> /etc/ssl/webhook-receiver.crt</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="dt">ssl_key_path </span><span class="ot">=</span><span class="st"> /etc/ssl/webhook-receiver.key</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># SL1 API Settings</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="dt">sl1_api_url </span><span class="ot">=</span><span class="st"> https://sl1.company.com/api/alert</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="dt">sl1_username </span><span class="ot">=</span><span class="st"> your_sl1_username</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="dt">sl1_password </span><span class="ot">=</span><span class="st"> your_sl1_password</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="dt">sl1_timeout </span><span class="ot">=</span><span class="st"> 30s</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="dt">sl1_retry_attempts </span><span class="ot">=</span><span class="st"> </span><span class="dv">3</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Threading Settings</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="dt">max_threads </span><span class="ot">=</span><span class="st"> </span><span class="dv">50</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="dt">queue_size </span><span class="ot">=</span><span class="st"> </span><span class="dv">10000</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="dt">thread_timeout </span><span class="ot">=</span><span class="st"> 30s</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Logging</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="dt">log_level </span><span class="ot">=</span><span class="st"> INFO</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="dt">log_file </span><span class="ot">=</span><span class="st"> /var/log/webhook-receiver.log</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="dt">log_max_size </span><span class="ot">=</span><span class="st"> 100MB</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="dt">log_rotation </span><span class="ot">=</span><span class="st"> daily</span></span></code></pre></div>
<h2 data-number="1.7" id="development-phases"><span
class="header-section-number">1.7</span> Development Phases</h2>
<h3 data-number="1.7.1" id="phase-1-core-system"><span
class="header-section-number">1.7.1</span> Phase 1: Core System</h3>
<ul class="task-list">
<li><label><input type="checkbox" />HTTP server with webhook
endpoints</label></li>
<li><label><input type="checkbox" />Configuration file
parser</label></li>
<li><label><input type="checkbox" />JSON field extraction
engine</label></li>
<li><label><input type="checkbox" />Template processing
system</label></li>
<li><label><input type="checkbox" />Basic SL1 API
integration</label></li>
</ul>
<h3 data-number="1.7.2" id="phase-2-multi-threading"><span
class="header-section-number">1.7.2</span> Phase 2: Multi-Threading</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Thread pool
implementation</label></li>
<li><label><input type="checkbox" />Request queue system</label></li>
<li><label><input type="checkbox" />Error handling and
retries</label></li>
<li><label><input type="checkbox" />Graceful shutdown
handling</label></li>
<li><label><input type="checkbox" />Resource cleanup</label></li>
</ul>
<h3 data-number="1.7.3" id="phase-3-production-features"><span
class="header-section-number">1.7.3</span> Phase 3: Production
Features</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Webhook signature
verification</label></li>
<li><label><input type="checkbox" />Rate limiting and
throttling</label></li>
<li><label><input type="checkbox" />Comprehensive logging</label></li>
<li><label><input type="checkbox" />Metrics collection</label></li>
<li><label><input type="checkbox" />Health check endpoints</label></li>
</ul>
<h3 data-number="1.7.4" id="phase-4-operations"><span
class="header-section-number">1.7.4</span> Phase 4: Operations</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Configuration
validation</label></li>
<li><label><input type="checkbox" />Performance monitoring</label></li>
<li><label><input type="checkbox" />Alerting on failures</label></li>
<li><label><input type="checkbox" />Documentation and
runbooks</label></li>
<li><label><input type="checkbox" />Deployment automation</label></li>
</ul>
<h3 data-number="1.7.5" id="current-status"><span
class="header-section-number">1.7.5</span> Current Status</h3>
<p>üöÄ <strong>Phase 1</strong>: Core System (COMPLETED) - ‚úÖ FastAPI
HTTP server with webhook endpoints - ‚úÖ Configuration file parser and
management - ‚úÖ JSON field extraction engine with array support - ‚úÖ
Template processing system - ‚úÖ SL1 API integration with retry logic -
‚úÖ HTTPS/SSL support for secure webhooks - ‚úÖ Empty payload handling
with 202 responses</p>
<p>üéâ <strong>Phase 5</strong>: Web Configuration Interface (COMPLETED)
- ‚úÖ 3-step configuration wizard (payload analysis, field selection,
template building) - ‚úÖ Visual field discovery and selection from JSON
payloads - ‚úÖ Real-time testing of webhook configurations before saving
- ‚úÖ Edit mode for existing configurations with test payload support -
‚úÖ Enhanced field extraction engine with nested pattern parsing - ‚úÖ
Automatic configuration backup and file management - ‚úÖ Bootstrap 5
responsive web interface at http://localhost:8000/config - ‚úÖ
Production-ready with clean codebase and error handling</p>
<p>üîß <strong>Next Phases</strong>: Multi-Threading &amp; Production
Features (PLANNED) - üü° Thread pool implementation for high-volume
processing - üü° Advanced monitoring and metrics collection - üü°
Production deployment automation - üü° Load balancing and scaling
strategies</p>
<h2 data-number="1.8" id="production-deployment"><span
class="header-section-number">1.8</span> Production Deployment</h2>
<h3 data-number="1.8.1"
id="port-configuration-configuration-driven"><span
class="header-section-number">1.8.1</span> Port Configuration
(Configuration-Driven)</h3>
<p><strong>All port configuration is handled via config files - no code
changes required!</strong></p>
<h4 data-number="1.8.1.1" id="development-mode-default"><span
class="header-section-number">1.8.1.1</span> Development Mode
(default)</h4>
<ul>
<li>GenHook reads <code>backend/config/app-config.ini</code></li>
<li>Default port: 8000 (HTTP)</li>
<li>Access: http://localhost:8000</li>
</ul>
<h4 data-number="1.8.1.2" id="production-mode-options"><span
class="header-section-number">1.8.1.2</span> Production Mode
Options</h4>
<p><strong>Option 1: Direct HTTPS (Port 443)</strong></p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create backend/config/app-config.prod.ini</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">[server]</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="dt">host </span><span class="ot">=</span><span class="st"> 0.0.0.0</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="dt">port </span><span class="ot">=</span><span class="st"> </span><span class="dv">443</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="dt">reload </span><span class="ot">=</span><span class="st"> </span><span class="kw">false</span></span></code></pre></div>
<p><strong>Option 2: Reverse Proxy (Recommended)</strong></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep default port 8000 in app-config.ini</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Use nginx/Apache to proxy port 443 ‚Üí 8000</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">[server]</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="dt">host </span><span class="ot">=</span><span class="st"> 0.0.0.0</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="dt">port </span><span class="ot">=</span><span class="st"> </span><span class="dv">8000</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="dt">reload </span><span class="ot">=</span><span class="st"> </span><span class="kw">false</span></span></code></pre></div>
<p><strong>Option 3: Custom Port</strong></p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Any port you need</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">[server]</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="dt">host </span><span class="ot">=</span><span class="st"> 0.0.0.0</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="dt">port </span><span class="ot">=</span><span class="st"> 9000  # or any port</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="dt">reload </span><span class="ot">=</span><span class="st"> </span><span class="kw">false</span></span></code></pre></div>
<h4 data-number="1.8.1.3" id="port-configuration-logic"><span
class="header-section-number">1.8.1.3</span> Port Configuration
Logic</h4>
<ol type="1">
<li>If <code>app-config.prod.ini</code> exists ‚Üí uses production
config</li>
<li>Otherwise ‚Üí uses <code>app-config.ini</code> (development)</li>
<li>GenHook automatically detects and uses the appropriate config</li>
<li><strong>No code modification ever required</strong></li>
</ol>
<h4 data-number="1.8.1.4" id="endpoint-access"><span
class="header-section-number">1.8.1.4</span> Endpoint Access</h4>
<ul>
<li><strong>API Endpoints</strong>: <code>/webhook/{service}</code> for
webhook reception</li>
<li><strong>Web Interface</strong>: <code>/config</code> for
configuration management</li>
<li><strong>Health Check</strong>: <code>/health</code> for
monitoring</li>
<li><strong>API Documentation</strong>: <code>/docs</code> for FastAPI
swagger docs</li>
</ul>
<h3 data-number="1.8.2" id="aws-deployment-considerations"><span
class="header-section-number">1.8.2</span> AWS Deployment
Considerations</h3>
<ul>
<li><strong>Application Load Balancer</strong>: Route traffic to GenHook
instances</li>
<li><strong>Security Groups</strong>: Allow inbound 8000 from ALB,
outbound 443 to SL1</li>
<li><strong>Auto Scaling</strong>: Scale based on webhook volume
metrics</li>
<li><strong>CloudWatch</strong>: Monitor application logs and
metrics</li>
<li><strong>Secrets Manager</strong>: Store SL1 credentials
securely</li>
</ul>
<h3 data-number="1.8.3" id="reverse-proxy-configuration-nginx"><span
class="header-section-number">1.8.3</span> Reverse Proxy Configuration
(nginx)</h3>
<pre class="nginx"><code>server {
    listen 443 ssl;
    server_name your-genhook-domain.com;
    
    ssl_certificate /path/to/ssl/cert.crt;
    ssl_certificate_key /path/to/ssl/private.key;
    
    location / {
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}</code></pre>
<h3 data-number="1.8.4" id="environment-variables-for-production"><span
class="header-section-number">1.8.4</span> Environment Variables for
Production</h3>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set in production environment</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="va">GENHOOK_ENV</span><span class="op">=</span>production</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="va">SL1_API_URL</span><span class="op">=</span>https://your-sl1-instance.com/api/alert</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="va">SL1_USERNAME</span><span class="op">=</span>your_sl1_user</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="va">SL1_PASSWORD</span><span class="op">=</span>your_sl1_password</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="va">WEB_INTERFACE_ENABLED</span><span class="op">=</span>true</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="va">AUTO_RESTART_SERVICE</span><span class="op">=</span>true</span></code></pre></div>
<h3 data-number="1.8.5" id="configuration-files-for-production"><span
class="header-section-number">1.8.5</span> Configuration Files for
Production</h3>
<ul>
<li>Update <code>backend/config/web-config.ini</code> to set
<code>auto_restart_service = true</code></li>
<li>Ensure <code>backend/config/webhook-config.ini</code> contains your
webhook configurations</li>
<li>Backup configurations are stored in
<code>backend/config/backups/</code></li>
</ul>
<h3 data-number="1.8.6" id="security-checklist"><span
class="header-section-number">1.8.6</span> Security Checklist</h3>
<ul>
<li>‚úÖ HTTPS enabled for all webhook endpoints</li>
<li>‚úÖ Web interface accessible only from authorized networks</li>
<li>‚úÖ SL1 credentials stored securely (not in code)</li>
<li>‚úÖ Webhook signature verification enabled where possible</li>
<li>‚úÖ Rate limiting configured for webhook endpoints</li>
<li>‚úÖ Regular backup of configuration files</li>
</ul>
<h2 data-number="1.9" id="security-performance"><span
class="header-section-number">1.9</span> Security &amp; Performance</h2>
<h3 data-number="1.9.1" id="security-considerations"><span
class="header-section-number">1.9.1</span> Security Considerations</h3>
<ul>
<li><strong>Webhook Verification</strong>: Validate signatures from
webhook providers</li>
<li><strong>Rate Limiting</strong>: Prevent spam/DoS attacks</li>
<li><strong>Input Validation</strong>: Sanitize all webhook
payloads</li>
<li><strong>Authentication</strong>: Secure SL1 API credentials
(username/password for HTTP Basic Auth)</li>
<li><strong>HTTPS Only</strong>: Encrypt all webhook traffic</li>
</ul>
<h3 data-number="1.9.2" id="error-handling-strategy"><span
class="header-section-number">1.9.2</span> Error Handling Strategy</h3>
<ul>
<li><strong>Graceful Degradation</strong>: Continue processing other
webhooks</li>
<li><strong>Retry Logic</strong>: Exponential backoff for failed API
calls</li>
<li><strong>Dead Letter Queue</strong>: Store unprocessable
webhooks</li>
<li><strong>Circuit Breaker</strong>: Protect against downstream
failures</li>
<li><strong>Timeout Handling</strong>: Prevent hung threads</li>
</ul>
<h3 data-number="1.9.3" id="performance-optimization"><span
class="header-section-number">1.9.3</span> Performance Optimization</h3>
<ul>
<li><strong>Connection Pooling</strong>: Reuse HTTP connections to
SL1</li>
<li><strong>Batch Processing</strong>: Group multiple events when
possible</li>
<li><strong>Caching</strong>: Cache configuration and templates</li>
<li><strong>Metrics</strong>: Monitor processing times and
throughput</li>
<li><strong>Profiling</strong>: Identify bottlenecks in production</li>
</ul>
<h3 data-number="1.9.4" id="monitoring-points"><span
class="header-section-number">1.9.4</span> Monitoring Points</h3>
<ul>
<li><strong>Webhook Ingestion Rate</strong>: Webhooks received per
second</li>
<li><strong>Processing Latency</strong>: Time from receipt to SL1 API
call</li>
<li><strong>Error Rates</strong>: Failed processing percentage</li>
<li><strong>Queue Depth</strong>: Backlog of pending webhooks</li>
<li><strong>Thread Utilization</strong>: Active vs idle threads</li>
<li><strong>SL1 API Response Times</strong>: Downstream service
health</li>
</ul>
<h3 data-number="1.9.5" id="key-metrics-to-track"><span
class="header-section-number">1.9.5</span> Key Metrics to Track</h3>
<ul>
<li><strong>Webhook Reception Rate</strong>: webhooks/second by
type</li>
<li><strong>Processing Latency</strong>: 95th percentile processing
time</li>
<li><strong>Error Rate</strong>: Failed webhooks percentage</li>
<li><strong>SL1 API Success Rate</strong>: Successful API calls
percentage</li>
<li><strong>Queue Depth</strong>: Current backlog size</li>
<li><strong>Thread Pool Utilization</strong>: Active threads / total
threads</li>
</ul>
<h2 data-number="1.10" id="web-configuration-interface-plan"><span
class="header-section-number">1.10</span> Web Configuration Interface
Plan</h2>
<h3 data-number="1.10.1" id="overview-1"><span
class="header-section-number">1.10.1</span> Overview</h3>
<p>A comprehensive web-based interface for configuring GenHook webhooks
without manual file editing.</p>
<h3 data-number="1.10.2" id="key-features-1"><span
class="header-section-number">1.10.2</span> Key Features</h3>
<ul>
<li><strong>Visual Field Selection</strong>: Interactive tree view of
JSON payload fields</li>
<li><strong>Live Preview</strong>: Real-time message generation
preview</li>
<li><strong>Template Builder</strong>: Guided template creation with
variable suggestions<br />
</li>
<li><strong>Configuration Management</strong>: Safe config updates with
backup and rollback</li>
<li><strong>Service Integration</strong>: Automated service restart
after configuration changes</li>
</ul>
<h3 data-number="1.10.3" id="architecture-1"><span
class="header-section-number">1.10.3</span> Architecture</h3>
<ul>
<li><strong>Framework</strong>: FastAPI + Jinja2 templates + Vanilla
JavaScript</li>
<li><strong>Configuration-Driven</strong>: All settings externalized to
<code>web-config.ini</code></li>
<li><strong>Security</strong>: IP-based access control and input
validation</li>
<li><strong>File Operations</strong>: Atomic config updates with backup
mechanisms</li>
</ul>
<h3 data-number="1.10.4" id="implementation-structure"><span
class="header-section-number">1.10.4</span> Implementation
Structure</h3>
<pre><code>backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ web/                    # Web interface module
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes.py          # Web UI routes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services.py        # Config management logic
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ models.py          # Pydantic models
‚îÇ   ‚îú‚îÄ‚îÄ templates/             # Jinja2 HTML templates
‚îÇ   ‚îú‚îÄ‚îÄ static/               # CSS, JS, assets
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ web-config.ini        # Web interface configuration</code></pre>
<h3 data-number="1.10.5" id="user-workflow"><span
class="header-section-number">1.10.5</span> User Workflow</h3>
<ol type="1">
<li>Access web interface at <code>/config</code></li>
<li>Paste JSON payload from webhook source</li>
<li>Select fields using interactive tree interface</li>
<li>Build message template with live preview</li>
<li>Save configuration (auto-restarts service)</li>
<li>Test with actual webhook</li>
</ol>
<h3 data-number="1.10.6" id="documentation"><span
class="header-section-number">1.10.6</span> Documentation</h3>
<ul>
<li><strong>Full Implementation Plan</strong>:
<code>WEB_INTERFACE_PLAN.md</code></li>
<li><strong>Branch Strategy</strong>:
<code>feature/web-config-interface</code></li>
<li><strong>Status</strong>: Ready for implementation</li>
</ul>
<h3 data-number="1.10.7" id="benefits"><span
class="header-section-number">1.10.7</span> Benefits</h3>
<ul>
<li><strong>User-Friendly</strong>: No technical knowledge required</li>
<li><strong>Error Reduction</strong>: Visual field selection prevents
mistakes</li>
<li><strong>Fast Onboarding</strong>: Quick setup of new webhook
sources</li>
<li><strong>Safe Deployment</strong>: Backup and rollback
capabilities</li>
</ul>
<h1 data-number="2" id="genhook-production-deployment-guide"><span
class="header-section-number">2</span> GenHook Production Deployment
Guide</h1>
<h2 data-number="2.1" id="overview-2"><span
class="header-section-number">2.1</span> Overview</h2>
<p>This guide provides comprehensive instructions for deploying GenHook
to production with the web configuration interface. GenHook is designed
to be production-ready with proper security, monitoring, and scalability
considerations.</p>
<h2 data-number="2.2" id="architecture-overview"><span
class="header-section-number">2.2</span> Architecture Overview</h2>
<pre><code>Internet ‚Üí Load Balancer (443) ‚Üí Reverse Proxy ‚Üí GenHook (8000) ‚Üí SL1 API
                                       ‚Üì
                               Web Interface (/config)</code></pre>
<h2 data-number="2.3" id="pre-production-checklist"><span
class="header-section-number">2.3</span> Pre-Production Checklist</h2>
<h3 data-number="2.3.1" id="code-readiness"><span
class="header-section-number">2.3.1</span> ‚úÖ Code Readiness</h3>
<ul class="task-list">
<li><label><input type="checkbox" />All debug statements
removed</label></li>
<li><label><input type="checkbox" />Error handling
implemented</label></li>
<li><label><input type="checkbox" />Configuration
externalized</label></li>
<li><label><input type="checkbox" />Logging configured</label></li>
<li><label><input type="checkbox" />Health checks working</label></li>
</ul>
<h3 data-number="2.3.2" id="security"><span
class="header-section-number">2.3.2</span> ‚úÖ Security</h3>
<ul class="task-list">
<li><label><input type="checkbox" />HTTPS/SSL certificates
configured</label></li>
<li><label><input type="checkbox" />Webhook signature verification
enabled</label></li>
<li><label><input type="checkbox" />Rate limiting
implemented</label></li>
<li><label><input type="checkbox" />Access controls for web
interface</label></li>
<li><label><input type="checkbox" />SL1 credentials secured</label></li>
</ul>
<h3 data-number="2.3.3" id="configuration"><span
class="header-section-number">2.3.3</span> ‚úÖ Configuration</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Production webhook configurations
tested</label></li>
<li><label><input type="checkbox" />SL1 API connectivity
verified</label></li>
<li><label><input type="checkbox" />Web interface configurations
validated</label></li>
<li><label><input type="checkbox" />Backup strategy
implemented</label></li>
</ul>
<h2 data-number="2.4" id="port-configuration-strategy"><span
class="header-section-number">2.4</span> Port Configuration
Strategy</h2>
<p><strong>GenHook uses a configuration-driven approach - no code
changes required!</strong></p>
<h3 data-number="2.4.1" id="configuration-files"><span
class="header-section-number">2.4.1</span> Configuration Files</h3>
<ul>
<li><strong>Development</strong>:
<code>backend/config/app-config.ini</code> (default port 8000)</li>
<li><strong>Production</strong>:
<code>backend/config/app-config.prod.ini</code> (automatically detected
if exists)</li>
</ul>
<h3 data-number="2.4.2" id="port-configuration-options"><span
class="header-section-number">2.4.2</span> Port Configuration
Options</h3>
<h4 data-number="2.4.2.1" id="option-1-direct-https-port-443"><span
class="header-section-number">2.4.2.1</span> Option 1: Direct HTTPS
(Port 443)</h4>
<p>Create production config for direct HTTPS:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># backend/config/app-config.prod.ini</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">[server]</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="dt">host </span><span class="ot">=</span><span class="st"> 0.0.0.0</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="dt">port </span><span class="ot">=</span><span class="st"> </span><span class="dv">443</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="dt">reload </span><span class="ot">=</span><span class="st"> </span><span class="kw">false</span></span></code></pre></div>
<p><strong>Benefits</strong>: Direct HTTPS, no reverse proxy needed
<strong>Requirements</strong>: SSL certificates, root privileges for
port 443</p>
<h4 data-number="2.4.2.2" id="option-2-reverse-proxy-recommended"><span
class="header-section-number">2.4.2.2</span> Option 2: Reverse Proxy
(Recommended)</h4>
<p>Keep default port 8000, use nginx/Apache for HTTPS:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># backend/config/app-config.ini (unchanged)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">[server]</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="dt">host </span><span class="ot">=</span><span class="st"> 0.0.0.0</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="dt">port </span><span class="ot">=</span><span class="st"> </span><span class="dv">8000</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="dt">reload </span><span class="ot">=</span><span class="st"> </span><span class="kw">false</span></span></code></pre></div>
<p><strong>Benefits</strong>: Better security, easier SSL management,
load balancing <strong>Setup</strong>: Configure nginx/Apache to proxy
443 ‚Üí 8000</p>
<h4 data-number="2.4.2.3" id="option-3-custom-port"><span
class="header-section-number">2.4.2.3</span> Option 3: Custom Port</h4>
<p>Use any available port:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># backend/config/app-config.prod.ini</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">[server]</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="dt">host </span><span class="ot">=</span><span class="st"> 0.0.0.0</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="dt">port </span><span class="ot">=</span><span class="st"> 9000  # or any port</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="dt">reload </span><span class="ot">=</span><span class="st"> </span><span class="kw">false</span></span></code></pre></div>
<h3 data-number="2.4.3" id="configuration-priority"><span
class="header-section-number">2.4.3</span> Configuration Priority</h3>
<ol type="1">
<li>If <code>app-config.prod.ini</code> exists ‚Üí production config
used</li>
<li>Otherwise ‚Üí <code>app-config.ini</code> (development) used</li>
<li><strong>No code modification ever required</strong></li>
</ol>
<h2 data-number="2.5" id="deployment-options"><span
class="header-section-number">2.5</span> Deployment Options</h2>
<h3 data-number="2.5.1"
id="option-1-aws-ec2-with-application-load-balancer-recommended"><span
class="header-section-number">2.5.1</span> Option 1: AWS EC2 with
Application Load Balancer (Recommended)</h3>
<h4 data-number="2.5.1.1" id="infrastructure-setup"><span
class="header-section-number">2.5.1.1</span> Infrastructure Setup</h4>
<ol type="1">
<li><p><strong>EC2 Instance Configuration</strong></p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instance Type: t3.medium (2 vCPU, 4GB RAM) for moderate load</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Instance Type: c5.large (2 vCPU, 4GB RAM) for high load</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># OS: Amazon Linux 2 or Ubuntu 20.04 LTS</span></span></code></pre></div></li>
<li><p><strong>Security Group Configuration</strong></p>
<pre><code>Inbound Rules:
- Port 22 (SSH): Your IP only
- Port 8000: ALB Security Group only
- Port 443: ALB Security Group only (if using direct SSL)

Outbound Rules:
- Port 443 (HTTPS): SL1 API endpoints
- Port 80/443: Package updates</code></pre></li>
<li><p><strong>Application Load Balancer Setup</strong></p>
<pre><code>Target Group: GenHook instances on port 8000
Health Check: /health
SSL Certificate: AWS Certificate Manager</code></pre></li>
</ol>
<h4 data-number="2.5.1.2" id="installation-script"><span
class="header-section-number">2.5.1.2</span> Installation Script</h4>
<div class="sourceCode" id="cb21"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GenHook Production Installation Script</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Update system</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> yum update <span class="at">-y</span>  <span class="co"># Amazon Linux</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sudo apt update &amp;&amp; sudo apt upgrade -y  # Ubuntu</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Install Python 3.9+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> yum install python3 python3-pip git <span class="at">-y</span>  <span class="co"># Amazon Linux</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># sudo apt install python3 python3-pip git -y  # Ubuntu</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create genhook user</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> useradd <span class="at">-m</span> <span class="at">-s</span> /bin/bash genhook</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> mkdir <span class="at">-p</span> /opt/genhook</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> chown genhook:genhook /opt/genhook</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Clone repository</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook git clone https://github.com/rudipoppes/GenHook.git /opt/genhook</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /opt/genhook</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create virtual environment</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook python3 <span class="at">-m</span> venv venv</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook ./venv/bin/pip install <span class="at">-r</span> backend/requirements.txt</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create production configuration</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook cp backend/config/app-config.ini.example backend/config/app-config.ini</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook cp backend/config/web-config.ini.example backend/config/web-config.ini</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure port for production (IMPORTANT: Configuration-driven approach)</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 1: Direct HTTPS on port 443 (requires SSL certs)</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook cp backend/config/app-config.prod.ini.example backend/config/app-config.prod.ini</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook sed <span class="at">-i</span> <span class="st">&#39;s/port = 8000/port = 443/&#39;</span> backend/config/app-config.prod.ini</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 2: Keep port 8000 for reverse proxy (recommended)</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co"># No changes needed - use default port 8000 with nginx/ALB handling HTTPS</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create systemd service</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tee /etc/systemd/system/genhook.service <span class="op">&gt;</span> /dev/null <span class="op">&lt;&lt;EOF</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="st">[Unit]</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="st">Description=GenHook Webhook Receiver</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="st">After=network.target</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="st">[Service]</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="st">Type=simple</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="st">User=genhook</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="st">Group=genhook</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="st">WorkingDirectory=/opt/genhook/backend</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="st">Environment=PYTHONPATH=/opt/genhook/backend</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="st">ExecStart=/opt/genhook/venv/bin/python main.py</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a><span class="st">Restart=always</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="st">RestartSec=3</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a><span class="st"># Environment variables</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a><span class="st">Environment=&quot;SL1_API_URL=https://your-sl1-instance.com/api/alert&quot;</span></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a><span class="st">Environment=&quot;SL1_USERNAME=your_sl1_user&quot;</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a><span class="st">Environment=&quot;SL1_PASSWORD=your_sl1_password&quot;</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a><span class="st">Environment=&quot;WEB_INTERFACE_ENABLED=true&quot;</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a><span class="st">[Install]</span></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a><span class="st">WantedBy=multi-user.target</span></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Start and enable service</span></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl daemon-reload</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl enable genhook</span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl start genhook</span></code></pre></div>
<h4 data-number="2.5.1.3" id="nginx-reverse-proxy-configuration"><span
class="header-section-number">2.5.1.3</span> Nginx Reverse Proxy
Configuration</h4>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install Nginx</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> yum install nginx <span class="at">-y</span>  <span class="co"># Amazon Linux</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sudo apt install nginx -y  # Ubuntu</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create configuration</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tee /etc/nginx/sites-available/genhook <span class="op">&gt;</span> /dev/null <span class="op">&lt;&lt;EOF</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="st">server {</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="st">    listen 80;</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="st">    server_name your-genhook-domain.com;</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="st">    return 301 https://</span><span class="dt">\$</span><span class="st">server_name</span><span class="dt">\$</span><span class="st">request_uri;</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="st">server {</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="st">    listen 443 ssl http2;</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="st">    server_name your-genhook-domain.com;</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="st">    # SSL Configuration</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="st">    ssl_certificate /etc/ssl/certs/genhook.crt;</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="st">    ssl_certificate_key /etc/ssl/private/genhook.key;</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="st">    ssl_protocols TLSv1.2 TLSv1.3;</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="st">    ssl_ciphers HIGH:!aNULL:!MD5;</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="st">    # Security Headers</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="st">    add_header X-Frame-Options DENY;</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="st">    add_header X-Content-Type-Options nosniff;</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="st">    add_header X-XSS-Protection &quot;1; mode=block&quot;;</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="st">    add_header Strict-Transport-Security &quot;max-age=31536000; includeSubDomains&quot; always;</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="st">    # Webhook endpoints (public)</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="st">    location /webhook/ {</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="st">        proxy_pass http://localhost:8000;</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="st">        proxy_set_header Host </span><span class="dt">\$</span><span class="st">host;</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="st">        proxy_set_header X-Real-IP </span><span class="dt">\$</span><span class="st">remote_addr;</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="st">        proxy_set_header X-Forwarded-For </span><span class="dt">\$</span><span class="st">proxy_add_x_forwarded_for;</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="st">        proxy_set_header X-Forwarded-Proto </span><span class="dt">\$</span><span class="st">scheme;</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a><span class="st">        # Rate limiting</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="st">        limit_req zone=webhook_limit burst=10 nodelay;</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="st">    # Health check (public)</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a><span class="st">    location /health {</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a><span class="st">        proxy_pass http://localhost:8000;</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a><span class="st">        access_log off;</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a><span class="st">    # Web interface (restrict access)</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a><span class="st">    location /config {</span></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a><span class="st">        # Restrict to specific IPs</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a><span class="st">        allow 10.0.0.0/8;    # Private networks</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a><span class="st">        allow 192.168.0.0/16;</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a><span class="st">        deny all;</span></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a><span class="st">        proxy_pass http://localhost:8000;</span></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a><span class="st">        proxy_set_header Host </span><span class="dt">\$</span><span class="st">host;</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a><span class="st">        proxy_set_header X-Real-IP </span><span class="dt">\$</span><span class="st">remote_addr;</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a><span class="st">        proxy_set_header X-Forwarded-For </span><span class="dt">\$</span><span class="st">proxy_add_x_forwarded_for;</span></span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a><span class="st">        proxy_set_header X-Forwarded-Proto </span><span class="dt">\$</span><span class="st">scheme;</span></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a><span class="st">    # Static files for web interface</span></span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a><span class="st">    location /static/ {</span></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a><span class="st">        # Same IP restrictions as /config</span></span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a><span class="st">        allow 10.0.0.0/8;</span></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a><span class="st">        allow 192.168.0.0/16;</span></span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a><span class="st">        deny all;</span></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a><span class="st">        proxy_pass http://localhost:8000;</span></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a><span class="st">    # Block other access</span></span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a><span class="st">    location / {</span></span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a><span class="st">        return 404;</span></span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a><span class="st"># Rate limiting zone</span></span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a><span class="st">http {</span></span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a><span class="st">    limit_req_zone </span><span class="dt">\$</span><span class="st">binary_remote_addr zone=webhook_limit:10m rate=10r/s;</span></span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable site</span></span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ln <span class="at">-s</span> /etc/nginx/sites-available/genhook /etc/nginx/sites-enabled/</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> nginx <span class="at">-t</span></span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl enable nginx</span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl restart nginx</span></code></pre></div>
<h3 data-number="2.5.2" id="option-2-docker-deployment"><span
class="header-section-number">2.5.2</span> Option 2: Docker
Deployment</h3>
<h4 data-number="2.5.2.1" id="dockerfile"><span
class="header-section-number">2.5.2.1</span> Dockerfile</h4>
<div class="sourceCode" id="cb23"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> python:3.9-slim</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Install system dependencies</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">apt-get</span> update <span class="kw">&amp;&amp;</span> <span class="ex">apt-get</span> install <span class="at">-y</span> <span class="dt">\</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    git <span class="dt">\</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&amp;&amp;</span> <span class="fu">rm</span> <span class="at">-rf</span> /var/lib/apt/lists/<span class="pp">*</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create app user</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">useradd</span> <span class="at">-m</span> <span class="at">-s</span> /bin/bash genhook</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set working directory</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /app</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy requirements first for caching</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> backend/requirements.txt .</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">pip</span> install <span class="at">--no-cache-dir</span> <span class="at">-r</span> requirements.txt</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy application code</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> backend/ .</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Set ownership</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="fu">chown</span> <span class="at">-R</span> genhook:genhook /app</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="kw">USER</span> genhook</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Expose port</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPOSE</span> 8000</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Health check</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="kw">HEALTHCHECK</span> <span class="op">--interval=30s</span> <span class="op">--timeout=10s</span> <span class="op">--start-period=5s</span> <span class="op">--retries=3</span> \</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CMD</span> <span class="ex">python</span> <span class="at">-c</span> <span class="st">&quot;import requests; requests.get(&#39;http://localhost:8000/health&#39;)&quot;</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Start application</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;python&quot;</span>, <span class="st">&quot;main.py&quot;</span>]</span></code></pre></div>
<h4 data-number="2.5.2.2" id="docker-compose"><span
class="header-section-number">2.5.2.2</span> Docker Compose</h4>
<div class="sourceCode" id="cb24"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3.8&#39;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">genhook</span><span class="kw">:</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">build</span><span class="kw">:</span><span class="at"> .</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;8000:8000&quot;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> SL1_API_URL=https://your-sl1-instance.com/api/alert</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> SL1_USERNAME=your_sl1_user</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> SL1_PASSWORD=your_sl1_password</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> WEB_INTERFACE_ENABLED=true</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./config:/app/config</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./logs:/app/logs</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">restart</span><span class="kw">:</span><span class="at"> unless-stopped</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">healthcheck</span><span class="kw">:</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">test</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&quot;CMD&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;curl&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;-f&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;http://localhost:8000/health&quot;</span><span class="kw">]</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">interval</span><span class="kw">:</span><span class="at"> 30s</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">timeout</span><span class="kw">:</span><span class="at"> 10s</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">retries</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">nginx</span><span class="kw">:</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx:alpine</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;443:443&quot;</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;80:80&quot;</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./nginx.conf:/etc/nginx/nginx.conf</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./ssl:/etc/ssl</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">depends_on</span><span class="kw">:</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> genhook</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">restart</span><span class="kw">:</span><span class="at"> unless-stopped</span></span></code></pre></div>
<h2 data-number="2.6" id="configuration-management-1"><span
class="header-section-number">2.6</span> Configuration Management</h2>
<h3 data-number="2.6.1" id="production-configuration-files"><span
class="header-section-number">2.6.1</span> Production Configuration
Files</h3>
<ol type="1">
<li><p><strong>Backend Configuration
(<code>backend/config/app-config.ini</code>)</strong></p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[server]</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="dt">host </span><span class="ot">=</span><span class="st"> 0.0.0.0</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="dt">port </span><span class="ot">=</span><span class="st"> </span><span class="dv">8000</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="dt">log_level </span><span class="ot">=</span><span class="st"> INFO</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="kw">[sl1]</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="dt">api_url </span><span class="ot">=</span><span class="st"> ${SL1_API_URL}</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="dt">username </span><span class="ot">=</span><span class="st"> ${SL1_USERNAME}</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="dt">password </span><span class="ot">=</span><span class="st"> ${SL1_PASSWORD}</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="dt">timeout </span><span class="ot">=</span><span class="st"> </span><span class="dv">30</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="dt">retry_attempts </span><span class="ot">=</span><span class="st"> </span><span class="dv">3</span></span></code></pre></div></li>
<li><p><strong>Web Interface Configuration
(<code>backend/config/web-config.ini</code>)</strong></p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[ui]</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="dt">enabled </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="dt">max_analysis_depth </span><span class="ot">=</span><span class="st"> </span><span class="dv">3</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="dt">timeout_seconds </span><span class="ot">=</span><span class="st"> </span><span class="dv">30</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="kw">[features]</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="dt">auto_restart_service </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="dt">backup_configs </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="kw">[paths]</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="dt">config_file_path </span><span class="ot">=</span><span class="st"> config/webhook-config.ini</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="dt">backup_directory </span><span class="ot">=</span><span class="st"> config/backups</span></span></code></pre></div></li>
<li><p><strong>Webhook Configuration
(<code>backend/config/webhook-config.ini</code>)</strong></p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[webhooks]</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Your production webhook configurations</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="dt">github </span><span class="ot">=</span><span class="st"> action,pull_request{title,user{login}},repository{name}::GitHub $action$ on $repository.name$: &quot;$pull_request.title$&quot; by $pull_request.user.login$</span></span></code></pre></div></li>
</ol>
<h2 data-number="2.7" id="monitoring-and-logging"><span
class="header-section-number">2.7</span> Monitoring and Logging</h2>
<h3 data-number="2.7.1" id="cloudwatch-integration-aws"><span
class="header-section-number">2.7.1</span> CloudWatch Integration
(AWS)</h3>
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add to main.py for AWS CloudWatch logging</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> boto3</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure CloudWatch logging</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>cloudwatch_logs <span class="op">=</span> boto3.client(<span class="st">&#39;logs&#39;</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CloudWatchHandler(logging.Handler):</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, log_group, log_stream):</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.log_group <span class="op">=</span> log_group</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.log_stream <span class="op">=</span> log_stream</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> emit(<span class="va">self</span>, record):</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        log_entry <span class="op">=</span> {</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: <span class="bu">int</span>(record.created <span class="op">*</span> <span class="dv">1000</span>),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;message&#39;</span>: <span class="va">self</span>.<span class="bu">format</span>(record)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>            cloudwatch_logs.put_log_events(</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>                logGroupName<span class="op">=</span><span class="va">self</span>.log_group,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>                logStreamName<span class="op">=</span><span class="va">self</span>.log_stream,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>                logEvents<span class="op">=</span>[log_entry]</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Failed to send log to CloudWatch: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> os.getenv(<span class="st">&#39;AWS_CLOUDWATCH_ENABLED&#39;</span>):</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    cloudwatch_handler <span class="op">=</span> CloudWatchHandler(<span class="st">&#39;genhook&#39;</span>, <span class="st">&#39;application&#39;</span>)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    logger.addHandler(cloudwatch_handler)</span></code></pre></div>
<h3 data-number="2.7.2" id="metrics-and-alerts"><span
class="header-section-number">2.7.2</span> Metrics and Alerts</h3>
<div class="sourceCode" id="cb29"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CloudWatch Custom Metrics</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> cloudwatch put-metric-data <span class="dt">\</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--namespace</span> <span class="st">&quot;GenHook&quot;</span> <span class="dt">\</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--metric-data</span> MetricName=WebhooksProcessed,Value=1,Unit=Count</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># CloudWatch Alarms</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> cloudwatch put-metric-alarm <span class="dt">\</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alarm-name</span> <span class="st">&quot;GenHook-High-Error-Rate&quot;</span> <span class="dt">\</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alarm-description</span> <span class="st">&quot;GenHook error rate is too high&quot;</span> <span class="dt">\</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">--metric-name</span> ErrorRate <span class="dt">\</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">--namespace</span> GenHook <span class="dt">\</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">--statistic</span> Average <span class="dt">\</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">--period</span> 300 <span class="dt">\</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">--threshold</span> 5.0 <span class="dt">\</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">--comparison-operator</span> GreaterThanThreshold <span class="dt">\</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">--evaluation-periods</span> 2</span></code></pre></div>
<h2 data-number="2.8" id="security-configuration"><span
class="header-section-number">2.8</span> Security Configuration</h2>
<h3 data-number="2.8.1" id="ssltls-setup"><span
class="header-section-number">2.8.1</span> SSL/TLS Setup</h3>
<div class="sourceCode" id="cb30"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate SSL certificate (Let&#39;s Encrypt)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> certbot <span class="at">--nginx</span> <span class="at">-d</span> your-genhook-domain.com</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Or use self-signed for testing</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> req <span class="at">-x509</span> <span class="at">-newkey</span> rsa:4096 <span class="at">-keyout</span> genhook.key <span class="at">-out</span> genhook.crt <span class="at">-days</span> 365 <span class="at">-nodes</span></span></code></pre></div>
<h3 data-number="2.8.2" id="access-control"><span
class="header-section-number">2.8.2</span> Access Control</h3>
<pre class="nginx"><code># IP-based access control in nginx
location /config {
    allow 203.0.113.0/24;  # Your office IP range
    allow 198.51.100.0/24; # Your VPN IP range
    deny all;
}</code></pre>
<h3 data-number="2.8.3" id="webhook-signature-verification"><span
class="header-section-number">2.8.3</span> Webhook Signature
Verification</h3>
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add to webhook endpoints for signature verification</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hmac</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> verify_signature(payload, signature, secret):</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    expected <span class="op">=</span> hmac.new(</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        secret.encode(<span class="st">&#39;utf-8&#39;</span>),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        payload,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        hashlib.sha256</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    ).hexdigest()</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hmac.compare_digest(signature, expected)</span></code></pre></div>
<h2 data-number="2.9" id="backup-and-recovery"><span
class="header-section-number">2.9</span> Backup and Recovery</h2>
<h3 data-number="2.9.1" id="automated-backups"><span
class="header-section-number">2.9.1</span> Automated Backups</h3>
<div class="sourceCode" id="cb33"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Backup script for GenHook configurations</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="va">BACKUP_DIR</span><span class="op">=</span><span class="st">&quot;/opt/genhook-backups&quot;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="va">DATE</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> +%Y%m%d_%H%M%S<span class="va">)</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="va">CONFIG_DIR</span><span class="op">=</span><span class="st">&quot;/opt/genhook/backend/config&quot;</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create backup directory</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$BACKUP_DIR</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Backup configurations</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> <span class="at">-czf</span> <span class="va">$BACKUP_DIR</span>/genhook-config-<span class="va">$DATE</span>.tar.gz <span class="at">-C</span> <span class="va">$CONFIG_DIR</span> .</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload to S3 (optional)</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> s3 cp <span class="va">$BACKUP_DIR</span>/genhook-config-<span class="va">$DATE</span>.tar.gz s3://your-backup-bucket/genhook/</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only last 30 days of backups</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> <span class="va">$BACKUP_DIR</span> <span class="at">-name</span> <span class="st">&quot;genhook-config-*.tar.gz&quot;</span> <span class="at">-mtime</span> +30 <span class="at">-delete</span></span></code></pre></div>
<h3 data-number="2.9.2" id="recovery-procedure"><span
class="header-section-number">2.9.2</span> Recovery Procedure</h3>
<div class="sourceCode" id="cb34"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stop service</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl stop genhook</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Restore configuration</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /opt/genhook/backend/config</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook tar <span class="at">-xzf</span> /path/to/backup.tar.gz</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Start service</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl start genhook</span></code></pre></div>
<h2 data-number="2.10" id="performance-tuning"><span
class="header-section-number">2.10</span> Performance Tuning</h2>
<h3 data-number="2.10.1" id="application-settings"><span
class="header-section-number">2.10.1</span> Application Settings</h3>
<div class="sourceCode" id="cb35"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In app-config.ini</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="kw">[performance]</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="dt">worker_processes </span><span class="ot">=</span><span class="st"> </span><span class="dv">4</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="dt">max_connections </span><span class="ot">=</span><span class="st"> </span><span class="dv">1000</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="dt">keepalive_timeout </span><span class="ot">=</span><span class="st"> </span><span class="dv">65</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="dt">client_max_body_size </span><span class="ot">=</span><span class="st"> 10M</span></span></code></pre></div>
<h3 data-number="2.10.2" id="system-tuning"><span
class="header-section-number">2.10.2</span> System Tuning</h3>
<div class="sourceCode" id="cb36"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Increase file descriptor limits</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;genhook soft nofile 65536&quot;</span> <span class="op">&gt;&gt;</span> /etc/security/limits.conf</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;genhook hard nofile 65536&quot;</span> <span class="op">&gt;&gt;</span> /etc/security/limits.conf</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tune network settings</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;net.core.somaxconn = 65536&quot;</span> <span class="op">&gt;&gt;</span> /etc/sysctl.conf</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;net.ipv4.tcp_max_syn_backlog = 65536&quot;</span> <span class="op">&gt;&gt;</span> /etc/sysctl.conf</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="ex">sysctl</span> <span class="at">-p</span></span></code></pre></div>
<h2 data-number="2.11" id="troubleshooting"><span
class="header-section-number">2.11</span> Troubleshooting</h2>
<h3 data-number="2.11.1" id="common-issues"><span
class="header-section-number">2.11.1</span> Common Issues</h3>
<ol type="1">
<li><p><strong>Port 8000 Already in Use</strong></p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> netstat <span class="at">-tulpn</span> <span class="kw">|</span> <span class="fu">grep</span> :8000</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl stop genhook</span></code></pre></div></li>
<li><p><strong>SL1 API Connection Issues</strong></p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> POST https://your-sl1-instance.com/api/alert <span class="dt">\</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">-u</span> username:password <span class="dt">\</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">-d</span> <span class="st">&#39;{&quot;message&quot;: &quot;Test&quot;}&#39;</span></span></code></pre></div></li>
<li><p><strong>Web Interface Not Loading</strong></p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> http://localhost:8000/config</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> journalctl <span class="at">-u</span> genhook <span class="at">-f</span></span></code></pre></div></li>
</ol>
<h3 data-number="2.11.2" id="log-analysis"><span
class="header-section-number">2.11.2</span> Log Analysis</h3>
<div class="sourceCode" id="cb40"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check application logs</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> journalctl <span class="at">-u</span> genhook <span class="at">-f</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check nginx logs</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tail <span class="at">-f</span> /var/log/nginx/access.log</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tail <span class="at">-f</span> /var/log/nginx/error.log</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Check GenHook application logs</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span> <span class="at">-f</span> /opt/genhook/logs/application.log</span></code></pre></div>
<h2 data-number="2.12" id="maintenance"><span
class="header-section-number">2.12</span> Maintenance</h2>
<h3 data-number="2.12.1" id="updates"><span
class="header-section-number">2.12.1</span> Updates</h3>
<div class="sourceCode" id="cb41"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update GenHook</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /opt/genhook</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook git pull origin main</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook ./venv/bin/pip install <span class="at">-r</span> backend/requirements.txt <span class="at">--upgrade</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl restart genhook</span></code></pre></div>
<h3 data-number="2.12.2" id="health-monitoring"><span
class="header-section-number">2.12.2</span> Health Monitoring</h3>
<div class="sourceCode" id="cb42"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Health check script</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="va">HEALTH_URL</span><span class="op">=</span><span class="st">&quot;http://localhost:8000/health&quot;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="va">RESPONSE</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-o</span> /dev/null <span class="at">-w</span> <span class="st">&quot;%{http_code}&quot;</span> <span class="va">$HEALTH_URL)</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$RESPONSE</span> <span class="ot">-ne</span> 200 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;GenHook health check failed: </span><span class="va">$RESPONSE</span><span class="st">&quot;</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sudo</span> systemctl restart genhook</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Send alert notification</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span></code></pre></div>
<p>This guide provides a comprehensive foundation for deploying GenHook
in production with proper security, monitoring, and maintenance
procedures.</p>
<h1 data-number="3" id="genhook-aws-deployment-guide"><span
class="header-section-number">3</span> GenHook AWS Deployment Guide</h1>
<h2 data-number="3.1" id="overview-3"><span
class="header-section-number">3.1</span> Overview</h2>
<p>This guide provides detailed instructions for deploying GenHook on
AWS with high availability, security, and scalability. The architecture
uses Application Load Balancer, Auto Scaling, and CloudWatch for a
production-ready deployment.</p>
<h2 data-number="3.2" id="architecture-diagram"><span
class="header-section-number">3.2</span> Architecture Diagram</h2>
<pre><code>Internet
    ‚Üì
Application Load Balancer (ALB)
    ‚Üì
Target Group (Health Checks)
    ‚Üì
Auto Scaling Group
    ‚Üì
EC2 Instances (GenHook)
    ‚Üì
SL1 API (External)</code></pre>
<h2 data-number="3.3" id="aws-services-used"><span
class="header-section-number">3.3</span> AWS Services Used</h2>
<ul>
<li><strong>EC2</strong>: Application hosting</li>
<li><strong>Application Load Balancer</strong>: Traffic distribution and
SSL termination</li>
<li><strong>Auto Scaling Group</strong>: Automatic scaling based on
load</li>
<li><strong>CloudWatch</strong>: Monitoring and alerting</li>
<li><strong>Secrets Manager</strong>: Secure credential storage</li>
<li><strong>Certificate Manager</strong>: SSL certificate
management</li>
<li><strong>Route 53</strong>: DNS management (optional)</li>
<li><strong>S3</strong>: Configuration backups (optional)</li>
</ul>
<h2 data-number="3.4" id="step-by-step-deployment"><span
class="header-section-number">3.4</span> Step-by-Step Deployment</h2>
<h3 data-number="3.4.1" id="vpc-and-security-setup"><span
class="header-section-number">3.4.1</span> 1. VPC and Security
Setup</h3>
<h4 data-number="3.4.1.1" id="create-security-groups"><span
class="header-section-number">3.4.1.1</span> Create Security Groups</h4>
<div class="sourceCode" id="cb44"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GenHook Application Security Group</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> ec2 create-security-group <span class="dt">\</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--group-name</span> genhook-app-sg <span class="dt">\</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--description</span> <span class="st">&quot;Security group for GenHook application&quot;</span> <span class="dt">\</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">--vpc-id</span> vpc-xxxxxxxxx</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Allow HTTP from ALB</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> ec2 authorize-security-group-ingress <span class="dt">\</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">--group-id</span> sg-xxxxxxxxx <span class="dt">\</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">--protocol</span> tcp <span class="dt">\</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">--port</span> 8000 <span class="dt">\</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">--source-group</span> sg-alb-xxxxxxxx</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Allow SSH for management</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> ec2 authorize-security-group-ingress <span class="dt">\</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">--group-id</span> sg-xxxxxxxxx <span class="dt">\</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">--protocol</span> tcp <span class="dt">\</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">--port</span> 22 <span class="dt">\</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">--cidr</span> 10.0.0.0/8</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Allow HTTPS outbound to SL1</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> ec2 authorize-security-group-egress <span class="dt">\</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">--group-id</span> sg-xxxxxxxxx <span class="dt">\</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">--protocol</span> tcp <span class="dt">\</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">--port</span> 443 <span class="dt">\</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">--cidr</span> 0.0.0.0/0</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="co"># ALB Security Group</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> ec2 create-security-group <span class="dt">\</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">--group-name</span> genhook-alb-sg <span class="dt">\</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">--description</span> <span class="st">&quot;Security group for GenHook ALB&quot;</span> <span class="dt">\</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">--vpc-id</span> vpc-xxxxxxxxx</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Allow HTTPS from Internet</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> ec2 authorize-security-group-ingress <span class="dt">\</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">--group-id</span> sg-alb-xxxxxxxx <span class="dt">\</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">--protocol</span> tcp <span class="dt">\</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">--port</span> 443 <span class="dt">\</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">--cidr</span> 0.0.0.0/0</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Allow HTTP (for redirect)</span></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> ec2 authorize-security-group-ingress <span class="dt">\</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">--group-id</span> sg-alb-xxxxxxxx <span class="dt">\</span></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">--protocol</span> tcp <span class="dt">\</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">--port</span> 80 <span class="dt">\</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">--cidr</span> 0.0.0.0/0</span></code></pre></div>
<h3 data-number="3.4.2" id="ssl-certificate-setup"><span
class="header-section-number">3.4.2</span> 2. SSL Certificate Setup</h3>
<div class="sourceCode" id="cb45"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Request certificate via AWS Certificate Manager</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> acm request-certificate <span class="dt">\</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--domain-name</span> genhook.yourdomain.com <span class="dt">\</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--domain-name</span> <span class="st">&quot;*.yourdomain.com&quot;</span> <span class="dt">\</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">--validation-method</span> DNS <span class="dt">\</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">--subject-alternative-names</span> genhook-api.yourdomain.com</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Note the ARN for ALB configuration</span></span></code></pre></div>
<h3 data-number="3.4.3" id="secrets-manager-setup"><span
class="header-section-number">3.4.3</span> 3. Secrets Manager Setup</h3>
<div class="sourceCode" id="cb46"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store SL1 credentials in Secrets Manager</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> secretsmanager create-secret <span class="dt">\</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--name</span> genhook/sl1-credentials <span class="dt">\</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--description</span> <span class="st">&quot;SL1 API credentials for GenHook&quot;</span> <span class="dt">\</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">--secret-string</span> <span class="st">&#39;{</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;api_url&quot;: &quot;https://your-sl1-instance.com/api/alert&quot;,</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;username&quot;: &quot;your_sl1_username&quot;,</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;password&quot;: &quot;your_sl1_password&quot;</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="st">    }&#39;</span></span></code></pre></div>
<h3 data-number="3.4.4" id="launch-template-creation"><span
class="header-section-number">3.4.4</span> 4. Launch Template
Creation</h3>
<p>Create a launch template for GenHook instances:</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create launch template</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> ec2 create-launch-template <span class="dt">\</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--launch-template-name</span> genhook-template <span class="dt">\</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--launch-template-data</span> <span class="st">&#39;{</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;ImageId&quot;: &quot;ami-0c02fb55956c7d316&quot;,</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;InstanceType&quot;: &quot;t3.medium&quot;,</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;KeyName&quot;: &quot;your-key-pair&quot;,</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;SecurityGroupIds&quot;: [&quot;sg-xxxxxxxxx&quot;],</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;IamInstanceProfile&quot;: {</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;Name&quot;: &quot;GenHookInstanceProfile&quot;</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="st">        },</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;UserData&quot;: &quot;&#39;</span><span class="va">$(</span><span class="fu">base64</span> <span class="at">-w</span> 0 user-data.sh<span class="va">)</span><span class="st">&#39;&quot;</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="st">    }&#39;</span></span></code></pre></div>
<h4 data-number="3.4.4.1" id="user-data-script-user-data.sh"><span
class="header-section-number">3.4.4.1</span> User Data Script
(<code>user-data.sh</code>)</h4>
<div class="sourceCode" id="cb48"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="ex">yum</span> update <span class="at">-y</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="ex">yum</span> install <span class="at">-y</span> python3 python3-pip git amazon-cloudwatch-agent</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Install AWS CLI</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="st">&quot;https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip&quot;</span> <span class="at">-o</span> <span class="st">&quot;awscliv2.zip&quot;</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span> awscliv2.zip</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ./aws/install</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create genhook user</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="ex">useradd</span> <span class="at">-m</span> <span class="at">-s</span> /bin/bash genhook</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup GenHook</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> /opt/genhook</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="fu">chown</span> genhook:genhook /opt/genhook</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /opt/genhook</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Clone repository</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook git clone https://github.com/rudipoppes/GenHook.git .</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup Python environment</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook python3 <span class="at">-m</span> venv venv</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-u</span> genhook ./venv/bin/pip install <span class="at">-r</span> backend/requirements.txt</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Get secrets from AWS Secrets Manager</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="va">SECRET</span><span class="op">=</span><span class="va">$(</span><span class="ex">aws</span> secretsmanager get-secret-value <span class="dt">\</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">--secret-id</span> genhook/sl1-credentials <span class="dt">\</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">--region</span> us-east-1 <span class="dt">\</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">--query</span> SecretString <span class="at">--output</span> text<span class="va">)</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="va">SL1_API_URL</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$SECRET</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> .api_url<span class="va">)</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a><span class="va">SL1_USERNAME</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$SECRET</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> .username<span class="va">)</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="va">SL1_PASSWORD</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$SECRET</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> .password<span class="va">)</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create production configuration</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="op">&gt;</span> backend/config/app-config.ini <span class="op">&lt;&lt;EOF</span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="st">[server]</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="st">host = 0.0.0.0</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="st">port = 8000</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a><span class="st">log_level = INFO</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a><span class="st">[sl1]</span></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a><span class="st">api_url = </span><span class="va">$SL1_API_URL</span></span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a><span class="st">username = </span><span class="va">$SL1_USERNAME</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="st">password = </span><span class="va">$SL1_PASSWORD</span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a><span class="st">timeout = 30</span></span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a><span class="st">retry_attempts = 3</span></span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="op">&gt;</span> backend/config/web-config.ini <span class="op">&lt;&lt;EOF</span></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a><span class="st">[ui]</span></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a><span class="st">enabled = true</span></span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a><span class="st">max_analysis_depth = 3</span></span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a><span class="st">timeout_seconds = 30</span></span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a><span class="st">[features]</span></span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a><span class="st">auto_restart_service = true</span></span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a><span class="st">backup_configs = true</span></span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a><span class="st">[paths]</span></span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a><span class="st">config_file_path = config/webhook-config.ini</span></span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a><span class="st">backup_directory = config/backups</span></span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Create systemd service</span></span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="op">&gt;</span> /etc/systemd/system/genhook.service <span class="op">&lt;&lt;EOF</span></span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a><span class="st">[Unit]</span></span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a><span class="st">Description=GenHook Webhook Receiver</span></span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a><span class="st">After=network.target</span></span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a><span class="st">[Service]</span></span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a><span class="st">Type=simple</span></span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a><span class="st">User=genhook</span></span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a><span class="st">Group=genhook</span></span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a><span class="st">WorkingDirectory=/opt/genhook/backend</span></span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a><span class="st">Environment=PYTHONPATH=/opt/genhook/backend</span></span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a><span class="st">ExecStart=/opt/genhook/venv/bin/python main.py</span></span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a><span class="st">Restart=always</span></span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a><span class="st">RestartSec=3</span></span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a><span class="st">[Install]</span></span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a><span class="st">WantedBy=multi-user.target</span></span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup CloudWatch agent</span></span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="op">&gt;</span> /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.json <span class="op">&lt;&lt;EOF</span></span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a><span class="st">{</span></span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;logs&quot;: {</span></span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;logs_collected&quot;: {</span></span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;files&quot;: {</span></span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;collect_list&quot;: [</span></span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a><span class="st">                    {</span></span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a><span class="st">                        &quot;file_path&quot;: &quot;/opt/genhook/logs/application.log&quot;,</span></span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a><span class="st">                        &quot;log_group_name&quot;: &quot;genhook&quot;,</span></span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a><span class="st">                        &quot;log_stream_name&quot;: &quot;application&quot;</span></span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true" tabindex="-1"></a><span class="st">                    }</span></span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true" tabindex="-1"></a><span class="st">                ]</span></span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb48-99"><a href="#cb48-99" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb48-100"><a href="#cb48-100" aria-hidden="true" tabindex="-1"></a><span class="st">    },</span></span>
<span id="cb48-101"><a href="#cb48-101" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;metrics&quot;: {</span></span>
<span id="cb48-102"><a href="#cb48-102" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;namespace&quot;: &quot;GenHook/Application&quot;,</span></span>
<span id="cb48-103"><a href="#cb48-103" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;metrics_collected&quot;: {</span></span>
<span id="cb48-104"><a href="#cb48-104" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;cpu&quot;: {</span></span>
<span id="cb48-105"><a href="#cb48-105" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;measurement&quot;: [</span></span>
<span id="cb48-106"><a href="#cb48-106" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;cpu_usage_idle&quot;,</span></span>
<span id="cb48-107"><a href="#cb48-107" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;cpu_usage_iowait&quot;,</span></span>
<span id="cb48-108"><a href="#cb48-108" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;cpu_usage_user&quot;,</span></span>
<span id="cb48-109"><a href="#cb48-109" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;cpu_usage_system&quot;</span></span>
<span id="cb48-110"><a href="#cb48-110" aria-hidden="true" tabindex="-1"></a><span class="st">                ],</span></span>
<span id="cb48-111"><a href="#cb48-111" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;metrics_collection_interval&quot;: 60</span></span>
<span id="cb48-112"><a href="#cb48-112" aria-hidden="true" tabindex="-1"></a><span class="st">            },</span></span>
<span id="cb48-113"><a href="#cb48-113" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;disk&quot;: {</span></span>
<span id="cb48-114"><a href="#cb48-114" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;measurement&quot;: [</span></span>
<span id="cb48-115"><a href="#cb48-115" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;used_percent&quot;</span></span>
<span id="cb48-116"><a href="#cb48-116" aria-hidden="true" tabindex="-1"></a><span class="st">                ],</span></span>
<span id="cb48-117"><a href="#cb48-117" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;metrics_collection_interval&quot;: 60,</span></span>
<span id="cb48-118"><a href="#cb48-118" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;resources&quot;: [</span></span>
<span id="cb48-119"><a href="#cb48-119" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;*&quot;</span></span>
<span id="cb48-120"><a href="#cb48-120" aria-hidden="true" tabindex="-1"></a><span class="st">                ]</span></span>
<span id="cb48-121"><a href="#cb48-121" aria-hidden="true" tabindex="-1"></a><span class="st">            },</span></span>
<span id="cb48-122"><a href="#cb48-122" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;mem&quot;: {</span></span>
<span id="cb48-123"><a href="#cb48-123" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;measurement&quot;: [</span></span>
<span id="cb48-124"><a href="#cb48-124" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;mem_used_percent&quot;</span></span>
<span id="cb48-125"><a href="#cb48-125" aria-hidden="true" tabindex="-1"></a><span class="st">                ],</span></span>
<span id="cb48-126"><a href="#cb48-126" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;metrics_collection_interval&quot;: 60</span></span>
<span id="cb48-127"><a href="#cb48-127" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb48-128"><a href="#cb48-128" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb48-129"><a href="#cb48-129" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb48-130"><a href="#cb48-130" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb48-131"><a href="#cb48-131" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb48-132"><a href="#cb48-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-133"><a href="#cb48-133" aria-hidden="true" tabindex="-1"></a><span class="co"># Start services</span></span>
<span id="cb48-134"><a href="#cb48-134" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> daemon-reload</span>
<span id="cb48-135"><a href="#cb48-135" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> enable genhook</span>
<span id="cb48-136"><a href="#cb48-136" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> start genhook</span>
<span id="cb48-137"><a href="#cb48-137" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> enable amazon-cloudwatch-agent</span>
<span id="cb48-138"><a href="#cb48-138" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> start amazon-cloudwatch-agent</span></code></pre></div>
<h3 data-number="3.4.5" id="iam-roles-and-policies"><span
class="header-section-number">3.4.5</span> 5. IAM Roles and
Policies</h3>
<h4 data-number="3.4.5.1" id="create-iam-role-for-ec2-instances"><span
class="header-section-number">3.4.5.1</span> Create IAM Role for EC2
Instances</h4>
<div class="sourceCode" id="cb49"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;Version&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-10-17&quot;</span><span class="fu">,</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;Statement&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;Effect&quot;</span><span class="fu">:</span> <span class="st">&quot;Allow&quot;</span><span class="fu">,</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;Action&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;secretsmanager:GetSecretValue&quot;</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>            <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;Resource&quot;</span><span class="fu">:</span> <span class="st">&quot;arn:aws:secretsmanager:*:*:secret:genhook/sl1-credentials*&quot;</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;Effect&quot;</span><span class="fu">:</span> <span class="st">&quot;Allow&quot;</span><span class="fu">,</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;Action&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;cloudwatch:PutMetricData&quot;</span><span class="ot">,</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;logs:PutLogEvents&quot;</span><span class="ot">,</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;logs:CreateLogGroup&quot;</span><span class="ot">,</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;logs:CreateLogStream&quot;</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>            <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;Resource&quot;</span><span class="fu">:</span> <span class="st">&quot;*&quot;</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;Effect&quot;</span><span class="fu">:</span> <span class="st">&quot;Allow&quot;</span><span class="fu">,</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;Action&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;s3:PutObject&quot;</span><span class="ot">,</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;s3:GetObject&quot;</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>            <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;Resource&quot;</span><span class="fu">:</span> <span class="st">&quot;arn:aws:s3:::your-genhook-backups/*&quot;</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 data-number="3.4.6" id="application-load-balancer-setup"><span
class="header-section-number">3.4.6</span> 6. Application Load Balancer
Setup</h3>
<div class="sourceCode" id="cb50"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ALB</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> elbv2 create-load-balancer <span class="dt">\</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--name</span> genhook-alb <span class="dt">\</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--subnets</span> subnet-xxxxxx subnet-yyyyyy <span class="dt">\</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">--security-groups</span> sg-alb-xxxxxxxx <span class="dt">\</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">--scheme</span> internet-facing <span class="dt">\</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">--type</span> application <span class="dt">\</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">--ip-address-type</span> ipv4</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Target Group</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> elbv2 create-target-group <span class="dt">\</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">--name</span> genhook-tg <span class="dt">\</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">--protocol</span> HTTP <span class="dt">\</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">--port</span> 8000 <span class="dt">\</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">--vpc-id</span> vpc-xxxxxxxxx <span class="dt">\</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">--health-check-path</span> /health <span class="dt">\</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">--health-check-interval-seconds</span> 30 <span class="dt">\</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">--health-check-timeout-seconds</span> 5 <span class="dt">\</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">--healthy-threshold-count</span> 2 <span class="dt">\</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">--unhealthy-threshold-count</span> 3</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create HTTPS Listener</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> elbv2 create-listener <span class="dt">\</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">--load-balancer-arn</span> arn:aws:elasticloadbalancing:region:account:loadbalancer/app/genhook-alb/xxxxxxxxx <span class="dt">\</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">--protocol</span> HTTPS <span class="dt">\</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">--port</span> 443 <span class="dt">\</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">--certificates</span> CertificateArn=arn:aws:acm:region:account:certificate/xxxxxxxxx <span class="dt">\</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">--default-actions</span> Type=forward,TargetGroupArn=arn:aws:elasticloadbalancing:region:account:targetgroup/genhook-tg/xxxxxxxxx</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create HTTP Listener (redirect to HTTPS)</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> elbv2 create-listener <span class="dt">\</span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">--load-balancer-arn</span> arn:aws:elasticloadbalancing:region:account:loadbalancer/app/genhook-alb/xxxxxxxxx <span class="dt">\</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">--protocol</span> HTTP <span class="dt">\</span></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">--port</span> 80 <span class="dt">\</span></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">--default-actions</span> Type=redirect,RedirectConfig=<span class="st">&#39;{Protocol=HTTPS,Port=443,StatusCode=HTTP_301}&#39;</span></span></code></pre></div>
<h3 data-number="3.4.7" id="auto-scaling-group"><span
class="header-section-number">3.4.7</span> 7. Auto Scaling Group</h3>
<div class="sourceCode" id="cb51"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Auto Scaling Group</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> autoscaling create-auto-scaling-group <span class="dt">\</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--auto-scaling-group-name</span> genhook-asg <span class="dt">\</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--launch-template</span> LaunchTemplateName=genhook-template,Version=1 <span class="dt">\</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">--min-size</span> 2 <span class="dt">\</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">--max-size</span> 6 <span class="dt">\</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">--desired-capacity</span> 2 <span class="dt">\</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">--target-group-arns</span> arn:aws:elasticloadbalancing:region:account:targetgroup/genhook-tg/xxxxxxxxx <span class="dt">\</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">--health-check-type</span> ELB <span class="dt">\</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">--health-check-grace-period</span> 300 <span class="dt">\</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">--vpc-zone-identifier</span> <span class="st">&quot;subnet-xxxxxx,subnet-yyyyyy&quot;</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scaling policies</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> autoscaling put-scaling-policy <span class="dt">\</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">--auto-scaling-group-name</span> genhook-asg <span class="dt">\</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">--policy-name</span> genhook-scale-up <span class="dt">\</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">--policy-type</span> TargetTrackingScaling <span class="dt">\</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">--target-tracking-configuration</span> <span class="st">&#39;{</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;TargetValue&quot;: 70.0,</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;PredefinedMetricSpecification&quot;: {</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;PredefinedMetricType&quot;: &quot;ASGAverageCPUUtilization&quot;</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="st">        },</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;ScaleOutCooldown&quot;: 300,</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;ScaleInCooldown&quot;: 300</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="st">    }&#39;</span></span></code></pre></div>
<h3 data-number="3.4.8" id="cloudwatch-monitoring"><span
class="header-section-number">3.4.8</span> 8. CloudWatch Monitoring</h3>
<h4 data-number="3.4.8.1" id="custom-metrics"><span
class="header-section-number">3.4.8.1</span> Custom Metrics</h4>
<div class="sourceCode" id="cb52"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create CloudWatch dashboard</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> cloudwatch put-dashboard <span class="dt">\</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--dashboard-name</span> GenHook <span class="dt">\</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--dashboard-body</span> <span class="st">&#39;{</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;widgets&quot;: [</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="st">            {</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;type&quot;: &quot;metric&quot;,</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;properties&quot;: {</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;metrics&quot;: [</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="st">                        [&quot;AWS/ApplicationELB&quot;, &quot;RequestCount&quot;, &quot;LoadBalancer&quot;, &quot;app/genhook-alb/xxxxxxxxx&quot;],</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="st">                        [&quot;AWS/ApplicationELB&quot;, &quot;TargetResponseTime&quot;, &quot;LoadBalancer&quot;, &quot;app/genhook-alb/xxxxxxxxx&quot;],</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="st">                        [&quot;AWS/ApplicationELB&quot;, &quot;HTTPCode_ELB_5XX_Count&quot;, &quot;LoadBalancer&quot;, &quot;app/genhook-alb/xxxxxxxxx&quot;]</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="st">                    ],</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;period&quot;: 300,</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;stat&quot;: &quot;Sum&quot;,</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;region&quot;: &quot;us-east-1&quot;,</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;title&quot;: &quot;ALB Metrics&quot;</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="st">        ]</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="st">    }&#39;</span></span></code></pre></div>
<h4 data-number="3.4.8.2" id="alarms"><span
class="header-section-number">3.4.8.2</span> Alarms</h4>
<div class="sourceCode" id="cb53"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># High error rate alarm</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> cloudwatch put-metric-alarm <span class="dt">\</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alarm-name</span> <span class="st">&quot;GenHook-High-Error-Rate&quot;</span> <span class="dt">\</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alarm-description</span> <span class="st">&quot;GenHook 5XX error rate is too high&quot;</span> <span class="dt">\</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">--metric-name</span> HTTPCode_ELB_5XX_Count <span class="dt">\</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">--namespace</span> AWS/ApplicationELB <span class="dt">\</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">--statistic</span> Sum <span class="dt">\</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">--period</span> 300 <span class="dt">\</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">--threshold</span> 10 <span class="dt">\</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">--comparison-operator</span> GreaterThanThreshold <span class="dt">\</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">--evaluation-periods</span> 2 <span class="dt">\</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alarm-actions</span> arn:aws:sns:us-east-1:account:genhook-alerts</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="co"># High response time alarm</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> cloudwatch put-metric-alarm <span class="dt">\</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alarm-name</span> <span class="st">&quot;GenHook-High-Response-Time&quot;</span> <span class="dt">\</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alarm-description</span> <span class="st">&quot;GenHook response time is too high&quot;</span> <span class="dt">\</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">--metric-name</span> TargetResponseTime <span class="dt">\</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">--namespace</span> AWS/ApplicationELB <span class="dt">\</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">--statistic</span> Average <span class="dt">\</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">--period</span> 300 <span class="dt">\</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">--threshold</span> 2.0 <span class="dt">\</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">--comparison-operator</span> GreaterThanThreshold <span class="dt">\</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">--evaluation-periods</span> 2 <span class="dt">\</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alarm-actions</span> arn:aws:sns:us-east-1:account:genhook-alerts</span></code></pre></div>
<h3 data-number="3.4.9" id="route-53-dns-setup"><span
class="header-section-number">3.4.9</span> 9. Route 53 DNS Setup</h3>
<div class="sourceCode" id="cb54"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create hosted zone (if not exists)</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> route53 create-hosted-zone <span class="dt">\</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--name</span> yourdomain.com <span class="dt">\</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--caller-reference</span> <span class="va">$(</span><span class="fu">date</span> +%s<span class="va">)</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create A record pointing to ALB</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> route53 change-resource-record-sets <span class="dt">\</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">--hosted-zone-id</span> Z1234567890ABC <span class="dt">\</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">--change-batch</span> <span class="st">&#39;{</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;Changes&quot;: [{</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;Action&quot;: &quot;CREATE&quot;,</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;ResourceRecordSet&quot;: {</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;Name&quot;: &quot;genhook.yourdomain.com&quot;,</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;Type&quot;: &quot;A&quot;,</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;AliasTarget&quot;: {</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;DNSName&quot;: &quot;genhook-alb-xxxxxxxxx.us-east-1.elb.amazonaws.com&quot;,</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;EvaluateTargetHealth&quot;: true,</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="st">                    &quot;HostedZoneId&quot;: &quot;Z35SXDOTRQ7X7K&quot;</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="st">        }]</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="st">    }&#39;</span></span></code></pre></div>
<h3 data-number="3.4.10" id="configuration-backup-to-s3"><span
class="header-section-number">3.4.10</span> 10. Configuration Backup to
S3</h3>
<p>Add this to your GenHook application for automatic backups:</p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> boto3</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> S3ConfigBackup:</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, bucket_name):</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.s3_client <span class="op">=</span> boto3.client(<span class="st">&#39;s3&#39;</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.bucket_name <span class="op">=</span> bucket_name</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> backup_config(<span class="va">self</span>, config_data):</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        timestamp <span class="op">=</span> datetime.now().strftime(<span class="st">&#39;%Y%m</span><span class="sc">%d</span><span class="st">_%H%M%S&#39;</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> <span class="ss">f&quot;genhook/configs/backup_</span><span class="sc">{</span>timestamp<span class="sc">}</span><span class="ss">.json&quot;</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.s3_client.put_object(</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>                Bucket<span class="op">=</span><span class="va">self</span>.bucket_name,</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>                Key<span class="op">=</span>key,</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>                Body<span class="op">=</span>json.dumps(config_data, indent<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>                ContentType<span class="op">=</span><span class="st">&#39;application/json&#39;</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> key</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f&quot;Failed to backup config to S3: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span></code></pre></div>
<h2 data-number="3.5" id="web-interface-access-control"><span
class="header-section-number">3.5</span> Web Interface Access
Control</h2>
<h3 data-number="3.5.1" id="alb-listener-rules-for-web-interface"><span
class="header-section-number">3.5.1</span> ALB Listener Rules for Web
Interface</h3>
<div class="sourceCode" id="cb56"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create rule to restrict /config access</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> elbv2 create-rule <span class="dt">\</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--listener-arn</span> arn:aws:elasticloadbalancing:region:account:listener/app/genhook-alb/xxxxxxxxx/xxxxxxxxx <span class="dt">\</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--conditions</span> Field=path-pattern,Values=<span class="st">&#39;/config*&#39;</span> <span class="dt">\</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">--priority</span> 100 <span class="dt">\</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">--actions</span> Type=fixed-response,FixedResponseConfig=<span class="st">&#39;{StatusCode=403,ContentType=text/plain,MessageBody=&quot;Access Denied&quot;}&#39;</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create rule for specific IP ranges</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> elbv2 create-rule <span class="dt">\</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">--listener-arn</span> arn:aws:elasticloadbalancing:region:account:listener/app/genhook-alb/xxxxxxxxx/xxxxxxxxx <span class="dt">\</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">--conditions</span> Field=path-pattern,Values=<span class="st">&#39;/config*&#39;</span> Field=source-ip,Values=<span class="st">&#39;203.0.113.0/24,198.51.100.0/24&#39;</span> <span class="dt">\</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">--priority</span> 50 <span class="dt">\</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">--actions</span> Type=forward,TargetGroupArn=arn:aws:elasticloadbalancing:region:account:targetgroup/genhook-tg/xxxxxxxxx</span></code></pre></div>
<h2 data-number="3.6" id="cost-optimization"><span
class="header-section-number">3.6</span> Cost Optimization</h2>
<h3 data-number="3.6.1" id="instance-rightsizing"><span
class="header-section-number">3.6.1</span> Instance Rightsizing</h3>
<ul>
<li><strong>t3.micro</strong>: Development/testing (1 vCPU, 1GB RAM) -
~$8.50/month</li>
<li><strong>t3.small</strong>: Light production (2 vCPU, 2GB RAM) -
~$17/month<br />
</li>
<li><strong>t3.medium</strong>: Moderate load (2 vCPU, 4GB RAM) -
~$34/month</li>
<li><strong>c5.large</strong>: High performance (2 vCPU, 4GB RAM) -
~$62/month</li>
</ul>
<h3 data-number="3.6.2" id="reserved-instances"><span
class="header-section-number">3.6.2</span> Reserved Instances</h3>
<p>Consider Reserved Instances for 30-60% cost savings on long-term
deployments.</p>
<h2 data-number="3.7" id="disaster-recovery"><span
class="header-section-number">3.7</span> Disaster Recovery</h2>
<h3 data-number="3.7.1" id="multi-az-deployment"><span
class="header-section-number">3.7.1</span> Multi-AZ Deployment</h3>
<div class="sourceCode" id="cb57"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Deploy across multiple AZs</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aws</span> autoscaling update-auto-scaling-group <span class="dt">\</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--auto-scaling-group-name</span> genhook-asg <span class="dt">\</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--vpc-zone-identifier</span> <span class="st">&quot;subnet-xxxxxx,subnet-yyyyyy,subnet-zzzzzz&quot;</span></span></code></pre></div>
<h3 data-number="3.7.2" id="cross-region-backup"><span
class="header-section-number">3.7.2</span> Cross-Region Backup</h3>
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-region S3 backup</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>s3_client_dr <span class="op">=</span> boto3.client(<span class="st">&#39;s3&#39;</span>, region_name<span class="op">=</span><span class="st">&#39;us-west-2&#39;</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>s3_client_dr.copy_object(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    CopySource<span class="op">=</span>{<span class="st">&#39;Bucket&#39;</span>: <span class="st">&#39;genhook-backups&#39;</span>, <span class="st">&#39;Key&#39;</span>: config_key},</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    Bucket<span class="op">=</span><span class="st">&#39;genhook-backups-dr&#39;</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    Key<span class="op">=</span>config_key</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>This AWS deployment guide provides a robust, scalable, and secure
foundation for running GenHook in production on AWS infrastructure.</p>
</body>
</html>
