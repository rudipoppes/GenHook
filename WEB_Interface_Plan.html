<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>GenHook Web Interface Implementation Plan</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">GenHook Web Interface Implementation Plan</h1>
</header>
<h1
id="genhook-web-configuration-interface---implementation-plan">GenHook
Web Configuration Interface - Implementation Plan</h1>
<h2 id="project-overview"><strong>Project Overview</strong></h2>
<p>This plan outlines the implementation of a web-based configuration
interface for GenHook, allowing users to visually configure webhook
processing without editing configuration files manually.</p>
<h2 id="folder-structure-design"><strong>Folder Structure
Design:</strong></h2>
<pre><code>backend/
├── app/
│   ├── web/                    # New web interface module
│   │   ├── __init__.py
│   │   ├── routes.py          # Web UI routes (/config, /api/*)
│   │   ├── services.py        # Config management logic
│   │   └── models.py          # Pydantic models for web interface
│   ├── templates/             # Jinja2 HTML templates
│   │   ├── base.html
│   │   ├── config.html        # Main configuration interface
│   │   └── components/        # Reusable template components
│   ├── static/               # CSS, JS, assets
│   │   ├── css/
│   │   ├── js/
│   │   └── images/
│   └── core/                 # Existing core functionality
├── config/
│   ├── web-config.ini        # NEW: Web interface configuration
│   ├── app-config.ini        # Existing app config
│   └── webhook-config.ini    # Existing webhook config
└── tests/
    └── test_web_interface.py # Web interface tests</code></pre>
<h2 id="configuration-driven-design"><strong>Configuration-Driven
Design</strong></h2>
<h3 id="new-web-interface-config-configweb-config.ini"><strong>New Web
Interface Config (<code>config/web-config.ini</code>):</strong></h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[web]</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="dt">enabled </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="dt">host </span><span class="ot">=</span><span class="st"> 127.0.0.1</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="dt">port </span><span class="ot">=</span><span class="st"> </span><span class="dv">8000</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="dt">base_path </span><span class="ot">=</span><span class="st"> /config</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="dt">static_path </span><span class="ot">=</span><span class="st"> /static</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="dt">template_path </span><span class="ot">=</span><span class="st"> templates/</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">[security]</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="dt">require_auth </span><span class="ot">=</span><span class="st"> </span><span class="kw">false</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="dt">allowed_ips </span><span class="ot">=</span><span class="st"> 127.0.0.1,192.168.0.0/16</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="dt">max_payload_size </span><span class="ot">=</span><span class="st"> 10MB</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="dt">session_timeout </span><span class="ot">=</span><span class="st"> </span><span class="dv">3600</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="kw">[features]</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="dt">auto_restart_service </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="dt">backup_configs </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="dt">backup_retention_days </span><span class="ot">=</span><span class="st"> </span><span class="dv">30</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="dt">enable_config_validation </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="dt">enable_live_preview </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="kw">[service]</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="dt">supervisor_program_name </span><span class="ot">=</span><span class="st"> genhook</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="dt">config_file_path </span><span class="ot">=</span><span class="st"> config/webhook-config.ini</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="dt">restart_command </span><span class="ot">=</span><span class="st"> supervisorctl restart genhook</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="dt">backup_directory </span><span class="ot">=</span><span class="st"> backups/configs/</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="kw">[ui]</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="dt">theme </span><span class="ot">=</span><span class="st"> </span><span class="kw">default</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="dt">show_sample_values </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="dt">max_fields_display </span><span class="ot">=</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="dt">default_message_template </span><span class="ot">=</span><span class="st"> $service$ Alert: $summary$</span></span></code></pre></div>
<h2 id="implementation-phases"><strong>Implementation
Phases</strong></h2>
<h3 id="phase-1-configurable-foundation"><strong>Phase 1: Configurable
Foundation</strong></h3>
<h4 id="configuration-management-system"><strong>1.1 Configuration
Management System</strong></h4>
<ul>
<li>Create <code>WebConfig</code> class to load
<code>web-config.ini</code></li>
<li>Support environment variable overrides</li>
<li>Configuration validation with schema</li>
<li>Hot-reload configuration without restart</li>
</ul>
<h4 id="modular-web-interface"><strong>1.2 Modular Web
Interface</strong></h4>
<ul>
<li>Conditional web interface loading based on config</li>
<li>Pluggable authentication systems</li>
<li>Configurable UI themes and layouts</li>
<li>Dynamic route registration</li>
</ul>
<h4 id="flexible-file-management"><strong>1.3 Flexible File
Management</strong></h4>
<ul>
<li>Configurable paths for all files (templates, static, configs)</li>
<li>Pluggable backup strategies</li>
<li>Configurable service restart mechanisms</li>
<li>Support for different deployment environments</li>
</ul>
<h3 id="phase-2-core-web-interface"><strong>Phase 2: Core Web
Interface</strong></h3>
<h4 id="fastapi-web-integration"><strong>2.1 FastAPI Web
Integration</strong></h4>
<ul>
<li>Add Jinja2 templates and static file serving to FastAPI</li>
<li>Create <code>/config</code> web endpoint with HTML interface<br />
</li>
<li>Add professional CSS styling for the configuration UI</li>
<li>Add necessary dependencies to requirements.txt</li>
</ul>
<h4 id="json-payload-analysis-engine"><strong>2.2 JSON Payload Analysis
Engine</strong></h4>
<ul>
<li>Create <code>/api/analyze-payload</code> POST endpoint</li>
<li>Build recursive JSON field discovery that walks entire payload
structure</li>
<li>Detect and categorize field types (string, number, boolean, array,
object)</li>
<li>Handle deeply nested objects and array structures</li>
<li>Return structured field tree for UI consumption</li>
</ul>
<h4 id="interactive-field-selection-interface"><strong>2.3 Interactive
Field Selection Interface</strong></h4>
<ul>
<li>Create dynamic tree-view UI showing all discoverable fields</li>
<li>Add checkboxes for intuitive field selection</li>
<li>Show visual indicators distinguishing arrays from single values</li>
<li>Display sample values from actual JSON for context</li>
<li>Handle complex nested selections properly</li>
</ul>
<h3 id="phase-3-configuration-generation"><strong>Phase 3: Configuration
Generation</strong></h3>
<h4 id="genhook-config-string-generator"><strong>3.1 GenHook Config
String Generator</strong></h4>
<ul>
<li>Convert user field selections to proper GenHook syntax</li>
<li>Handle simple fields: <code>field_name</code></li>
<li>Handle nested fields: <code>object{subfield}</code>,
<code>deep{nested{field}}</code></li>
<li>Handle array fields: <code>array{property}</code> with proper array
support</li>
<li>Validate field combinations and syntax correctness</li>
</ul>
<h4 id="message-template-builder"><strong>3.2 Message Template
Builder</strong></h4>
<ul>
<li>Provide template editing interface with variable suggestions</li>
<li>Auto-complete available variables based on selected fields</li>
<li>Live preview showing generated message using sample data</li>
<li>Template syntax validation and error highlighting</li>
<li>Support for array variable formatting (comma-separated values)</li>
</ul>
<h3 id="phase-4-integration-deployment"><strong>Phase 4: Integration
&amp; Deployment</strong></h3>
<h4 id="configuration-file-management"><strong>4.1 Configuration File
Management</strong></h4>
<ul>
<li>Read current webhook-config.ini safely</li>
<li>Update specific webhook configurations without affecting others</li>
<li>Implement file locking during updates</li>
<li>Create automatic backup before changes</li>
<li>Validate entire config file after modifications</li>
</ul>
<h4 id="service-integration-restart"><strong>4.2 Service Integration
&amp; Restart</strong></h4>
<ul>
<li>Safe config file replacement with atomic operations</li>
<li>Automatic GenHook service restart via supervisorctl</li>
<li>Monitor restart success/failure with proper error handling</li>
<li>Implement rollback mechanism if restart fails</li>
<li>Status reporting to user interface</li>
</ul>
<h3 id="phase-5-enhanced-features"><strong>Phase 5: Enhanced
Features</strong></h3>
<h4 id="multi-configuration-management"><strong>5.1 Multi-Configuration
Management</strong></h4>
<ul>
<li>Manage all webhook types in single interface</li>
<li>Show current configurations with edit capabilities</li>
<li>Import/export functionality for webhook configs</li>
<li>Configuration templates for common webhook sources</li>
</ul>
<h4 id="testing-validation-features"><strong>5.2 Testing &amp;
Validation Features</strong></h4>
<ul>
<li>Test webhook configurations with sample payloads before saving</li>
<li>Show message preview with actual field extraction</li>
<li>Configuration diff viewer showing changes before applying</li>
<li>Validation warnings for potential issues</li>
</ul>
<h2 id="key-flexible-design-principles"><strong>Key Flexible Design
Principles</strong></h2>
<h3 id="no-hardcoded-values"><strong>No Hardcoded Values:</strong></h3>
<ul>
<li>✅ All paths configurable via config files</li>
<li>✅ All UI settings in configuration</li>
<li>✅ All service integration points configurable</li>
<li>✅ All security settings externalized</li>
</ul>
<h3 id="environment-agnostic"><strong>Environment
Agnostic:</strong></h3>
<ul>
<li>✅ Works in development, staging, production</li>
<li>✅ Supports different service managers</li>
<li>✅ Adapts to different deployment methods</li>
<li>✅ Configurable for different security requirements</li>
</ul>
<h3 id="modular-architecture"><strong>Modular
Architecture:</strong></h3>
<ul>
<li>✅ Web interface can be disabled entirely</li>
<li>✅ Components can be swapped/extended</li>
<li>✅ Different authentication methods</li>
<li>✅ Pluggable storage backends</li>
</ul>
<h3 id="configuration-hierarchy"><strong>Configuration
Hierarchy:</strong></h3>
<ol type="1">
<li><strong>Default values</strong> in code</li>
<li><strong>Config file values</strong> override defaults</li>
<li><strong>Environment variables</strong> override config files</li>
<li><strong>Runtime settings</strong> override everything</li>
</ol>
<h2 id="expected-user-workflow"><strong>Expected User
Workflow</strong></h2>
<ol type="1">
<li><strong>Access Interface</strong>: Navigate to
<code>https://genhook.ddns.net/config</code></li>
<li><strong>Input Payload</strong>: Paste JSON payload from webhook
documentation/testing</li>
<li><strong>Field Selection</strong>: Select desired fields from visual
tree interface</li>
<li><strong>Template Building</strong>: Build message template with live
preview feedback</li>
<li><strong>Configuration Review</strong>: Review generated
configuration and test with sample data</li>
<li><strong>Deploy</strong>: Save and auto-deploy (service restarts
automatically)</li>
<li><strong>Validation</strong>: Test with actual webhook to validate
configuration</li>
</ol>
<h2 id="technical-implementation-details"><strong>Technical
Implementation Details</strong></h2>
<ul>
<li><strong>Framework:</strong> FastAPI + Jinja2 templates + Vanilla
JavaScript</li>
<li><strong>Dependencies:</strong> Minimal additions (jinja2,
python-multipart)</li>
<li><strong>Security:</strong> IP-based access control for production
safety</li>
<li><strong>File Operations:</strong> Secure with proper permissions and
error handling</li>
<li><strong>Branch Strategy:</strong> Develop on
<code>feature/web-config-interface</code></li>
</ul>
<h2 id="benefits"><strong>Benefits</strong></h2>
<ul>
<li><strong>Non-technical users</strong> can configure webhooks
easily</li>
<li><strong>Reduced errors</strong> through visual field selection</li>
<li><strong>Faster onboarding</strong> of new webhook sources</li>
<li><strong>Live testing</strong> prevents configuration mistakes</li>
<li><strong>Safe deployment</strong> with rollback capabilities</li>
<li><strong>Environment flexibility</strong> through
configuration-driven design</li>
<li><strong>Maintainability</strong> through clear separation of
concerns</li>
</ul>
<h2 id="security-considerations"><strong>Security
Considerations</strong></h2>
<ul>
<li><strong>Authentication options</strong> configurable (none, basic,
IP-based)</li>
<li><strong>File access security</strong> with proper permissions</li>
<li><strong>Input validation</strong> for all user-provided data</li>
<li><strong>Safe service restart</strong> mechanisms</li>
<li><strong>Configuration backups</strong> before changes</li>
<li><strong>Rollback capabilities</strong> if issues occur</li>
</ul>
<h2 id="deployment-strategy"><strong>Deployment Strategy</strong></h2>
<ol type="1">
<li><strong>Development Branch</strong>: Create
<code>feature/web-config-interface</code></li>
<li><strong>Local Testing</strong>: Test all functionality locally</li>
<li><strong>Staging Deployment</strong>: Deploy to test environment</li>
<li><strong>Production Merge</strong>: Merge to main when stable</li>
<li><strong>Production Deployment</strong>: Deploy with configuration
updates</li>
</ol>
<hr />
<p><strong>Document Version</strong>: 1.0<br />
<strong>Created</strong>: January 2025<br />
<strong>Status</strong>: Implementation Ready</p>
</body>
</html>
